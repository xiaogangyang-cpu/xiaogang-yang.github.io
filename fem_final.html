<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æœ‰é™å…ƒä»¿çœŸæ€ç»´è®­ç»ƒ Â· 2å‡åŠ æ¹¿å™¨æ°´æµæ¨¡æ‹Ÿ Â· ç²¾è®²ç‰ˆ</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --bg-dark: #070d18; --card-bg: rgba(13,21,36,0.92); --card-bg-solid: #0d1524;
      --primary-blue: #2f8cff; --primary-glow: rgba(47,140,255,0.45);
      --accent-green: #2ecc71; --accent-orange: #f39c12; --accent-red: #e74c3c; --accent-purple: #9b59b6;
      --text-light: #e8f0f8; --text-dim: #96afc4; --text-muted: #566879;
      --border-blue: rgba(47,140,255,0.25); --border-hover: rgba(47,140,255,0.6);
      --shadow-heavy: 0 8px 40px rgba(0,0,0,0.65); --glow-blue: 0 0 20px rgba(47,140,255,0.25);
    }
    body { font-family:'Noto Sans SC',sans-serif; background:var(--bg-dark); color:var(--text-light); min-height:100vh; padding-bottom:3rem;
      background-image: radial-gradient(ellipse at 15% 25%,rgba(47,140,255,0.07) 0%,transparent 45%),
        radial-gradient(ellipse at 85% 70%,rgba(155,89,182,0.06) 0%,transparent 45%),
        radial-gradient(ellipse at 50% 100%,rgba(46,204,113,0.04) 0%,transparent 40%); }
    /* HEADER */
    header { background:linear-gradient(150deg,#05090f 0%,#0b1624 60%,#081220 100%); padding:2.2rem 2rem 1.8rem; text-align:center; border-bottom:1px solid var(--border-blue); box-shadow:var(--shadow-heavy); position:relative; overflow:hidden; }
    header::before { content:''; position:absolute; inset:0; background:radial-gradient(ellipse at 70% 50%,rgba(47,140,255,0.06) 0%,transparent 60%); }
    header::after { content:''; position:absolute; bottom:0; left:0; width:100%; height:2px; background:linear-gradient(90deg,transparent,var(--primary-blue),rgba(155,89,182,0.8),var(--primary-blue),transparent); }
    .header-badge { display:inline-block; background:rgba(47,140,255,0.1); border:1px solid var(--border-blue); color:var(--text-dim); font-size:0.68rem; letter-spacing:0.14em; padding:0.22rem 0.8rem; border-radius:20px; margin-bottom:0.8rem; font-family:'JetBrains Mono',monospace; }
    header h1 { font-size:clamp(1.25rem,2.8vw,1.85rem); font-weight:900; color:#fff; text-shadow:0 0 20px var(--primary-glow); margin-bottom:0.4rem; position:relative; }
    header .subtitle { font-size:0.85rem; color:var(--text-dim); font-weight:300; }
    .disclaimer-bar { background:rgba(0,0,0,0.55); border-top:1px solid var(--border-blue); text-align:center; padding:0.4rem; font-size:0.68rem; color:var(--text-muted); }
    /* GRID */
    .main-grid { display:grid; grid-template-columns:1fr 1fr; gap:1.4rem; max-width:1200px; margin:1.6rem auto; padding:0 1.4rem; }
    @media(max-width:900px){ .main-grid { grid-template-columns:1fr; } }
    .span-2 { grid-column:span 2; }
    @media(max-width:900px){ .span-2 { grid-column:span 1; } }
    /* CARD */
    .card { position:relative; background:var(--card-bg); backdrop-filter:blur(14px); border:1px solid var(--border-blue); border-radius:18px; box-shadow:var(--shadow-heavy); overflow:visible; display:flex; flex-direction:column; transition:border-color 0.25s,box-shadow 0.25s; }
    .card:hover { border-color:var(--border-hover); box-shadow:var(--shadow-heavy),var(--glow-blue); }
    .card-header { display:flex; align-items:center; gap:0.7rem; padding:0.95rem 1.2rem 0.7rem; border-bottom:1px solid var(--border-blue); flex-wrap:wrap; }
    .level-badge { width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:0.72rem; font-weight:700; color:white; flex-shrink:0; box-shadow:0 0 12px currentColor; }
    .level-1{background:linear-gradient(135deg,#2f8cff,#1a4d8c);} .level-2{background:linear-gradient(135deg,#2ecc71,#1a7040);}
    .level-3{background:linear-gradient(135deg,#f39c12,#a06008);} .level-4{background:linear-gradient(135deg,#e74c3c,#8c2020);}
    .level-5{background:linear-gradient(135deg,#9b59b6,#5e2980);}
    .card-title { font-size:0.92rem; font-weight:700; color:var(--text-light); }
    .card-subtitle { font-size:0.68rem; color:var(--text-muted); margin-top:0.1rem; }
    /* INFO BTN */
    .info-btn { display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; border-radius:50%; background:rgba(47,140,255,0.12); border:1px solid var(--border-blue); color:var(--text-dim); cursor:pointer; margin-left:0.4rem; transition:all 0.18s; font-size:0.78rem; flex-shrink:0; }
    .info-btn i { pointer-events:none; }
    .info-btn:hover, .info-btn.active { background:var(--primary-blue); color:#07101c; border-color:rgba(255,255,255,0.5); box-shadow:0 0 16px var(--primary-glow); transform:scale(1.08); }
    /* INFO POPUP */
    .info-popup { position:absolute; top:64px; left:16px; right:16px; width:calc(100% - 32px); background:rgba(5,12,24,0.98); backdrop-filter:blur(20px); border:1px solid var(--primary-blue); border-left:5px solid var(--primary-blue); border-radius:14px; padding:1.1rem 1.3rem; color:#cfe0f0; font-size:0.77rem; line-height:1.78; box-shadow:0 10px 40px rgba(0,0,0,0.85); z-index:600; display:none; pointer-events:none; }
    .info-popup::before { content:''; position:absolute; top:-10px; left:32px; border-left:9px solid transparent; border-right:9px solid transparent; border-bottom:10px solid var(--primary-blue); }
    .info-popup h4 { font-size:0.88rem; font-weight:800; color:#fff; margin-bottom:0.45rem; display:flex; align-items:center; gap:6px; }
    .info-popup h4 i { color:var(--primary-blue); } .info-popup strong { color:var(--primary-blue); } .info-popup p { margin-bottom:0.45rem; }
    .info-popup hr { margin:0.55rem 0; border:none; border-top:1px solid rgba(47,140,255,0.25); } .info-popup .hint { color:var(--text-muted); font-size:0.66rem; }
    /* CANVAS */
    .canvas-wrap { background:rgba(4,8,16,0.85); border-bottom:1px solid var(--border-blue); display:flex; justify-content:space-around; align-items:center; padding:0.5rem; flex-wrap:wrap; }
    canvas { display:block; border-radius:8px; max-width:100%; border:1px solid rgba(47,140,255,0.15); box-shadow:0 2px 16px rgba(0,0,0,0.7); margin:0.2rem; }
    .canvas-tooltip { position:absolute; background:rgba(0,0,0,0.92); border:1px solid var(--primary-blue); color:#e8f0f8; font-size:0.68rem; padding:0.28rem 0.55rem; border-radius:6px; pointer-events:none; display:none; z-index:10; white-space:nowrap; }
    /* CONTROLS */
    .controls { padding:0.75rem 1.1rem; display:flex; flex-wrap:wrap; gap:0.45rem; align-items:center; border-bottom:1px solid var(--border-blue); background:rgba(0,0,0,0.3); }
    .btn { background:rgba(13,21,36,0.85); border:1px solid var(--border-blue); color:var(--text-dim); border-radius:8px; padding:0.4rem 0.88rem; font-size:0.75rem; font-family:'Noto Sans SC',sans-serif; font-weight:600; cursor:pointer; transition:all 0.2s; }
    .btn:hover { background:var(--primary-blue); color:#07101c; border-color:rgba(255,255,255,0.5); box-shadow:0 0 16px var(--primary-glow); transform:translateY(-1px); }
    .btn.orange:hover { background:var(--accent-orange); color:#07101c; box-shadow:0 0 16px rgba(243,156,18,0.4); }
    .btn.purple:hover { background:var(--accent-purple); color:#fff; box-shadow:0 0 16px rgba(155,89,182,0.4); }
    .btn.red:hover { background:var(--accent-red); color:#fff; box-shadow:0 0 16px rgba(231,76,60,0.4); }
    .slider-group { display:flex; align-items:center; gap:0.38rem; background:rgba(0,0,0,0.45); border:1px solid var(--border-blue); padding:0.2rem 0.6rem; border-radius:20px; }
    .slider-group label { font-size:0.68rem; color:var(--text-dim); white-space:nowrap; }
    input[type=range] { width:78px; height:3px; background:rgba(47,140,255,0.2); border-radius:4px; appearance:none; accent-color:var(--primary-blue); cursor:pointer; }
    input[type=range]::-webkit-slider-thumb { appearance:none; width:13px; height:13px; background:var(--primary-blue); border-radius:50%; border:2px solid rgba(255,255,255,0.8); box-shadow:0 0 8px var(--primary-blue); cursor:pointer; }
    .val-tag { background:rgba(47,140,255,0.15); color:var(--primary-blue); font-family:'JetBrains Mono',monospace; font-size:0.67rem; font-weight:600; padding:0.1rem 0.38rem; border-radius:4px; min-width:38px; text-align:center; border:1px solid var(--border-blue); }
    .status-tag { display:inline-flex; align-items:center; gap:0.3rem; background:rgba(47,140,255,0.12); border:1px solid var(--border-blue); color:var(--text-dim); font-size:0.68rem; font-weight:600; padding:0.18rem 0.55rem; border-radius:20px; margin-left:auto; }
    .status-dot { width:6px; height:6px; border-radius:50%; background:var(--primary-blue); box-shadow:0 0 8px var(--primary-blue); }
    .desc { padding:0.8rem 1.1rem 0.9rem; font-size:0.75rem; line-height:1.8; color:var(--text-dim); font-weight:300; background:rgba(0,0,0,0.25); flex:1; }
    .desc strong { color:var(--primary-blue); font-weight:700; }
    .equation { background:rgba(0,0,0,0.55); border-left:3px solid var(--primary-blue); border-radius:4px; padding:0.38rem 0.65rem; margin:0.45rem 0; font-family:'JetBrains Mono',monospace; font-size:0.7rem; color:#b8cfe8; }
    .eq-red { color:#ff6b6b; font-weight:600; } .eq-blue { color:var(--primary-blue); font-weight:600; }
    /* EVAL FLOAT */
    .eval-float { position:fixed; bottom:1.8rem; right:1.8rem; z-index:500; background:linear-gradient(135deg,#9b59b6,#7c3aed); color:white; border:none; border-radius:50px; padding:0.7rem 1.4rem; font-size:0.82rem; font-family:'Noto Sans SC',sans-serif; font-weight:700; cursor:pointer; box-shadow:0 4px 24px rgba(155,89,182,0.55); transition:all 0.2s; }
    .eval-float:hover { transform:translateY(-2px); box-shadow:0 8px 32px rgba(155,89,182,0.7); }
    /* MODAL */
    .modal-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(2,5,12,0.92); backdrop-filter:blur(18px); display:flex; justify-content:center; align-items:center; z-index:9999; opacity:0; visibility:hidden; transition:all 0.3s; }
    .modal-overlay.active { opacity:1; visibility:visible; }
    .modal-content { background:var(--card-bg-solid); border:1px solid rgba(47,140,255,0.4); border-radius:22px; width:92%; max-width:960px; max-height:88vh; overflow-y:auto; padding:2rem; box-shadow:0 0 60px rgba(47,140,255,0.2); position:relative; color:var(--text-light); }
    .modal-content::-webkit-scrollbar { width:5px; } .modal-content::-webkit-scrollbar-track { background:rgba(0,0,0,0.3); } .modal-content::-webkit-scrollbar-thumb { background:rgba(47,140,255,0.4); border-radius:4px; }
    .modal-close { position:absolute; top:1.1rem; right:1.1rem; background:rgba(0,0,0,0.6); border:1px solid var(--border-blue); color:var(--text-dim); width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; font-size:1.1rem; transition:0.2s; }
    .modal-close:hover { background:var(--accent-red); color:#fff; }
    .modal-title { font-size:1.45rem; font-weight:800; margin-bottom:0.3rem; color:white; text-shadow:0 0 16px var(--primary-glow); border-bottom:1px solid var(--border-blue); padding-bottom:0.6rem; }
    .modal-subtitle { font-size:0.75rem; color:var(--text-muted); margin-bottom:1.2rem; }
    /* QUIZ */
    .quiz-grid { display:flex; flex-wrap:wrap; gap:1.8rem; }
    .quiz-left { flex:1.3; min-width:280px; } .quiz-right { flex:1; min-width:240px; display:flex; flex-direction:column; align-items:center; }
    .quiz-item { background:rgba(0,0,0,0.45); border:1px solid var(--border-blue); border-radius:12px; padding:1.1rem; margin-bottom:0.9rem; }
    .quiz-item.answered { border-color:rgba(47,140,255,0.5); }
    .quiz-question { font-size:0.88rem; font-weight:600; margin-bottom:0.7rem; color:var(--text-light); }
    .quiz-option { display:block; margin:0.35rem 0; padding:0.38rem 0.75rem; background:rgba(255,255,255,0.04); border-radius:7px; cursor:pointer; transition:0.15s; border:1px solid transparent; font-size:0.82rem; color:var(--text-dim); }
    .quiz-option:hover { background:rgba(47,140,255,0.1); border-color:var(--border-blue); }
    .quiz-option.selected { background:rgba(47,140,255,0.18); border-color:rgba(47,140,255,0.5); color:var(--text-light); }
    .quiz-option.correct { background:rgba(46,204,113,0.18); border-color:rgba(46,204,113,0.5); color:#2ecc71; }
    .quiz-option.wrong { background:rgba(231,76,60,0.15); border-color:rgba(231,76,60,0.4); color:#e74c3c; }
    .quiz-option input { margin-right:0.55rem; accent-color:var(--primary-blue); }
    #radarCanvas { background:rgba(4,8,16,0.9); border-radius:16px; border:1px solid var(--border-blue); box-shadow:0 0 24px rgba(0,0,0,0.8); }
    .radar-legend { display:flex; gap:1rem; justify-content:center; margin:0.5rem 0; font-size:0.7rem; }
    .radar-legend span { display:flex; align-items:center; gap:0.35rem; color:var(--text-dim); }
    .legend-dot-q { width:8px; height:8px; border-radius:50%; background:#2f8cff; display:inline-block; }
    .legend-dot-i { width:8px; height:8px; border-radius:2px; background:#2ecc71; border:1.5px dashed #2ecc71; display:inline-block; }
    .engineer-level { background:linear-gradient(145deg,#111e2e,#0a1320); border:1px solid rgba(47,140,255,0.45); border-radius:40px; padding:0.7rem 1.4rem; display:inline-block; margin:0.8rem 0 0.4rem; font-size:1rem; font-weight:700; color:white; text-shadow:0 0 10px var(--primary-glow); }
    .advice-text { background:rgba(0,0,0,0.5); border-left:5px solid var(--accent-orange); padding:1rem; border-radius:10px; font-size:0.8rem; line-height:1.75; color:var(--text-dim); width:100%; }
    .btn-eval { background:linear-gradient(135deg,var(--primary-blue),#1a5ccc); color:white; font-weight:700; border:none; border-radius:40px; padding:0.65rem 2rem; font-size:0.88rem; font-family:'Noto Sans SC',sans-serif; cursor:pointer; box-shadow:0 0 20px var(--primary-glow); margin-top:0.8rem; width:100%; transition:0.2s; }
    .btn-eval:hover { box-shadow:0 0 32px var(--primary-glow); transform:translateY(-1px); }
    .score-bar { width:100%; background:rgba(47,140,255,0.1); border-radius:8px; height:6px; margin-top:0.4rem; overflow:hidden; }
    .score-fill { height:100%; border-radius:8px; background:linear-gradient(90deg,var(--primary-blue),#7c3aed); transition:width 0.8s ease; }
    .total-score-display { text-align:center; font-size:2rem; font-weight:900; color:var(--primary-blue); text-shadow:0 0 16px var(--primary-glow); margin:0.5rem 0 0; }
    .interact-scores { width:100%; margin-top:0.6rem; display:grid; grid-template-columns:1fr 1fr; gap:0.4rem; }
    .interact-score-item { background:rgba(0,0,0,0.4); border:1px solid var(--border-blue); border-radius:8px; padding:0.4rem 0.6rem; font-size:0.68rem; color:var(--text-dim); }
    .interact-score-item strong { color:#2ecc71; }
    footer { text-align:center; font-size:0.68rem; color:var(--text-muted); padding:1.1rem; border-top:1px solid var(--border-blue); margin-top:1rem; background:rgba(5,9,16,0.8); }
  </style>
</head>
<body>

<header>
  <div class="header-badge">CAE EDUCATIONAL SIMULATOR Â· FEM THINKING TRAINING</div>
  <h1>ğŸ’§ æœ‰é™å…ƒä»¿çœŸæ€ç»´è®­ç»ƒ Â· 2å‡åŠ æ¹¿å™¨æ°´æµæ¨¡æ‹Ÿ</h1>
  <p class="subtitle">äº”å…³é€’è¿›â€”â€”ä»å‡ ä½•åˆ°ç½‘æ ¼ï¼Œä»ç¦»æ•£åˆ°è€¦åˆï¼Œç ´è§£CAEé»‘ç®±</p>
</header>
<div class="disclaimer-bar">âš ï¸ æœ¬æ¼”ç¤ºä¸ºæœ‰é™å…ƒæ€ç»´è®­ç»ƒï¼Œä¸è¿›è¡ŒçœŸå®æ•°å€¼æ±‚è§£ï¼Œæ‰€æœ‰æµåœºä¸ºç¤ºæ„æ€§å¯è§†åŒ–</div>

<div class="main-grid">

  <!-- LEVEL 1 -->
  <div class="card" id="card-level1">
    <div class="card-header">
      <div class="level-badge level-1">01</div>
      <div><div class="card-title"><i class="fas fa-cube fa-sm"></i> å‡ ä½•æŠ½è±¡ä¸é™ç»´</div><div class="card-subtitle">3Dæµä½“åŸŸ â†’ 2Dè½´å¯¹ç§°æˆªé¢</div></div>
      <span class="info-btn" data-popup="popup1" title="ç²¾è®²"><i class="fa-solid fa-lightbulb"></i></span>
      <div class="status-tag" id="status1"><span class="status-dot"></span><span id="status1txt">3DÂ·2Då¯¹æ¯”</span></div>
    </div>
    <div class="canvas-wrap" style="position:relative;">
      <canvas id="canvas1" width="560" height="220"></canvas>
      <div class="canvas-tooltip" id="tooltip1">å‡ ä½•ç‰¹å¾ä¿ç•™ï¼šè¶…å£°æŒ¯å­é©±åŠ¨åŒºåŸŸ</div>
    </div>
    <div class="info-popup" id="popup1">
      <h4><i class="fas fa-cube"></i> ç¬¬ä¸€å…³Â·å‡ ä½•é™ç»´ç²¾è®²</h4>
      <p><strong>è°ƒæ§ç›®æ ‡ï¼š</strong>ç†è§£æœ‰é™å…ƒ"å‡ ä½•æ¸…ç†"ä¸é™ç»´åŸåˆ™ã€‚è°ƒæ•´ä¸‰ç»´è§†è§’/æ°´ä½/é€æ˜åº¦ï¼Œç‚¹å‡»ä¸€é”®ç®€åŒ–ï¼Œå¯¹æ¯”3Dä¸2Dè½´å¯¹ç§°æ¨¡å‹çš„è®¡ç®—åŸŸå·®å¼‚ã€‚</p>
      <p><strong>æœºç†è§£é‡Šï¼š</strong>åŠ æ¹¿å™¨å†…å«å€’è§’ã€ç®¡è·¯ç­‰å¾®ç»†ç»“æ„ï¼Œå¯¹å®è§‚æ°´æµå½±å“æå¼±ã€‚FEMç¬¬ä¸€æ­¥åˆ©ç”¨è½´å¯¹ç§°æ€§å°†3Dç­’ä½“ç®€åŒ–ä¸º2Dæˆªé¢ï¼Œè‡ªç”±åº¦å‡å°‘&gt;90%ï¼Œä¿ç•™æŒ¯å­é©±åŠ¨ã€æ°´ä½ç­‰å…³é”®ç‰©ç†ã€‚</p>
      <p><strong>èƒ½åŠ›å®ç°ï¼š</strong>â‘ æ—‹è½¬æ»‘å—æ„Ÿå—ä¸‰ç»´ç©ºé—´ä¸æˆªé¢å…³ç³»ï¼›â‘¡è°ƒèŠ‚æ°´ä½/é€æ˜åº¦ï¼›â‘¢ç‚¹å‡»ã€ä¸€é”®ç®€åŒ–ã€‘è§¦å‘é™ç»´åŠ¨ç”»ï¼Œä½“ä¼š"ç‰¹å¾æŠ‘åˆ¶"ã€‚</p>
      <hr><span class="hint">âº æ»‘å—è°ƒæ§è§†è§’/æ°´ä½/é€æ˜åº¦ï¼›ç®€åŒ–æŒ‰é’®å®æ—¶å¯¹æ¯”é™ç»´æ•ˆæœ</span>
    </div>
    <div class="controls">
      <button class="btn" id="simplifyBtn">ğŸ” ä¸€é”®ç®€åŒ–</button>
      <button class="btn" id="resetBtn1">â†© é‡ç½®</button>
      <div class="slider-group"><label>æ—‹è½¬è§’</label><input type="range" id="rotSlider" min="0" max="60" value="22"><span class="val-tag" id="rotVal">22Â°</span></div>
      <div class="slider-group"><label>é€è§†</label><input type="range" id="depSlider" min="10" max="50" value="28"><span class="val-tag" id="depVal">28</span></div>
      <div class="slider-group"><label>æ°´ä½</label><input type="range" id="wlSlider" min="20" max="90" value="67"><span class="val-tag" id="wlVal">67%</span></div>
      <div class="slider-group"><label>3Dé€æ˜</label><input type="range" id="alphaSlider" min="20" max="90" value="70"><span class="val-tag" id="alphaVal">0.70</span></div>
    </div>
    <div class="desc" id="desc1">å®é™…åŠ æ¹¿å™¨åŒ…å«è®¸å¤šå¾®å°ç‰¹å¾ã€‚æœ‰é™å…ƒç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­å“ªäº›ç‰¹å¾å½±å“åŠ›å­¦è¡Œä¸ºï¼Œå°†<strong>3Dç®€åŒ–ä¸º2Dè½´å¯¹ç§°</strong>ï¼Œè®¡ç®—é‡å‡å°‘ <strong>90%</strong> ä»¥ä¸Šã€‚<br>æ‹–æ‹½æ»‘å—è°ƒèŠ‚ä¸‰ç»´è§†è§’/æ°´ä½/é€æ˜åº¦ï¼Œç‚¹å‡»ã€ä¸€é”®ç®€åŒ–ã€‘è§‚å¯Ÿé™ç»´è¿‡ç¨‹ã€‚</div>
  </div>

  <!-- LEVEL 2 -->
  <div class="card" id="card-level2">
    <div class="card-header">
      <div class="level-badge level-2">02</div>
      <div><div class="card-title"><i class="fas fa-gear fa-sm"></i> æ§åˆ¶æ–¹ç¨‹ä¸å¾®å…ƒæ§åˆ¶ä½“</div><div class="card-subtitle">æ¯ä¸ªç®­å¤´ä»£è¡¨ä¸€ä¸ªæ§åˆ¶ä½“ï¼ˆè™šçº¿æ¡†ï¼‰å†…çš„æµé€Ÿ</div></div>
      <span class="info-btn" data-popup="popup2" title="ç²¾è®²"><i class="fa-solid fa-lightbulb"></i></span>
      <div class="status-tag" id="status2" style="color:#2ecc71;background:rgba(46,204,113,0.15);border-color:rgba(46,204,113,0.3);">
        <span class="status-dot" style="background:#2ecc71;box-shadow:0 0 8px #2ecc71;"></span><span id="status2txt">Re â‰ˆ 30</span>
      </div>
    </div>
    <div class="canvas-wrap"><canvas id="canvas2" width="560" height="220"></canvas></div>
    <div class="info-popup" id="popup2">
      <h4><i class="fas fa-gear"></i> ç¬¬äºŒå…³Â·æ§åˆ¶ä½“ä¸æ–¹ç¨‹ç²¾è®²</h4>
      <p><strong>è°ƒæ§ç›®æ ‡ï¼š</strong>è¯†åˆ«N-Sæ–¹ç¨‹ä¸­æƒ¯æ€§é¡¹ï¼ˆçº¢ï¼‰ä¸ç²˜æ€§é¡¹ï¼ˆè“ï¼‰çš„ç‰©ç†è§’è‰²ï¼›è°ƒæ•´é›·è¯ºæ•°/ç²˜åº¦è§‚å¯Ÿæµæ€æ¼”å˜ã€‚</p>
      <p><strong>æœºç†è§£é‡Šï¼š</strong>æ¯ä¸ªè™šçº¿çŸ©å½¢ä»£è¡¨ä¸€ä¸ªå¾®å…ƒæ§åˆ¶ä½“ï¼Œç®­å¤´ä¸ºå…¶å¹³å‡æµé€ŸçŸ¢é‡ã€‚Re = ÏUL/Î¼ â€”â€” ä½Reç²˜æ€§ä¸»å¯¼æµçº¿å¹³æ»‘ï¼›é«˜Reæƒ¯æ€§ä¸»å¯¼å‡ºç°æ¶¡æ—‹ã€‚æ§åˆ¶ä½“æ˜¯FVM/FEMçš„é›å½¢ã€‚</p>
      <p><strong>èƒ½åŠ›å®ç°ï¼š</strong>â‘ æ‹–åŠ¨Reä»0â†’100ï¼Œç®­å¤´ä»æ•´é½å˜ç´Šä¹±ï¼›â‘¡é™ä½ç²˜åº¦Î¼ç­‰ä»·æå‡Reï¼›â‘¢å»ºç«‹"æ— é‡çº²æ•°-æµåŠ¨å½¢æ€"ç›´è§‰ã€‚</p>
      <hr><span class="hint">âº é›·è¯ºæ•°æ§åˆ¶æƒ¯æ€§/ç²˜æ€§å¹³è¡¡ï¼Œæ˜¯CFDæ ¸å¿ƒæ— é‡çº²å‚æ•°</span>
    </div>
    <div class="controls">
      <div class="slider-group"><label>é›·è¯ºæ•° Re</label><input type="range" id="reSlider" min="0" max="100" value="30"><span class="val-tag" id="reVal">30</span></div>
      <div class="slider-group"><label>ç²˜åº¦ Î¼</label><input type="range" id="muSlider" min="1" max="20" value="10"><span class="val-tag" id="muVal">1.0</span></div>
    </div>
    <div class="desc" id="desc2">
      <div class="equation">Ï (<span class="eq-red">âˆ‚u/âˆ‚t + uÂ·âˆ‡u</span>) = -âˆ‡p + <span class="eq-blue">Î¼âˆ‡Â²u</span> + f</div>
      <span class="eq-red">â–  æƒ¯æ€§é¡¹</span> &nbsp;<span class="eq-blue">â–  ç²˜æ€§é¡¹</span><br>
      <strong>è™šçº¿çŸ©å½¢</strong>è¡¨ç¤ºç¦»æ•£åçš„å¾®å…ƒæ§åˆ¶ä½“ï¼Œç®­å¤´ä¸ºè¯¥æ§åˆ¶ä½“å†…çš„å¹³å‡æµé€Ÿã€‚é›·è¯ºæ•°å†³å®šæµåŠ¨å½¢æ€ã€‚
    </div>
  </div>

  <!-- LEVEL 3 -->
  <div class="card" id="card-level3">
    <div class="card-header">
      <div class="level-badge level-3">03</div>
      <div><div class="card-title"><i class="fas fa-sliders fa-sm"></i> è¾¹ç•Œæ¡ä»¶çš„æ§åˆ¶è®ºæ€ç»´</div><div class="card-subtitle">è¾¹ç•Œæ§åˆ¶ä½“é¢œè‰²æ ‡è¯†çº¦æŸç±»å‹</div></div>
      <span class="info-btn" data-popup="popup3" title="ç²¾è®²"><i class="fa-solid fa-lightbulb"></i></span>
      <div class="status-tag" id="status3" style="color:#f39c12;background:rgba(243,156,18,0.15);border-color:rgba(243,156,18,0.3);">
        <span class="status-dot" id="bc-dot" style="background:#2f8cff;box-shadow:0 0 8px #2f8cff;"></span><span id="status3txt">æ— æ»‘ç§»å£é¢</span>
      </div>
    </div>
    <div class="canvas-wrap"><canvas id="canvas3" width="560" height="220"></canvas></div>
    <div class="info-popup" id="popup3">
      <h4><i class="fas fa-sliders"></i> ç¬¬ä¸‰å…³Â·è¾¹ç•Œæ¡ä»¶ç²¾è®²</h4>
      <p><strong>è°ƒæ§ç›®æ ‡ï¼š</strong>æŒæ¡ä¸‰ç±»å…¸å‹è¾¹ç•Œï¼ˆæ— æ»‘ç§»/é€Ÿåº¦å…¥å£/æ»‘ç§»ï¼‰çš„æ•°å­¦æè¿°ä¸æµåœºé‡æ„æ•ˆåº”ã€‚ç‚¹å‡»æŒ¯å­æˆ–æŒ‰é’®å¾ªç¯åˆ‡æ¢ã€‚</p>
      <p><strong>æœºç†è§£é‡Šï¼š</strong>æ— æ»‘ç§»ï¼ˆè“ï¼‰ä»¤å£é¢æµé€Ÿä¸ºé›¶ï¼›é€Ÿåº¦å…¥å£ï¼ˆç»¿ï¼‰åœ¨æŒ¯å­å¤„èµ‹äºˆæ³•å‘é€Ÿåº¦æ¨¡æ‹Ÿå–·æµï¼›æ»‘ç§»å£é¢ï¼ˆæ©™ï¼‰å…è®¸åˆ‡å‘æµåŠ¨äº§ç”Ÿå›æµã€‚æ¯ä¸ªè¾¹ç•Œæ§åˆ¶ä½“å‡å½±å“ç›¸é‚»å†…éƒ¨èŠ‚ç‚¹çš„ä»£æ•°æ–¹ç¨‹ã€‚</p>
      <p><strong>èƒ½åŠ›å®ç°ï¼š</strong>â‘ è§‚å¯Ÿä¸åŒè¾¹ç•Œä¸‹æµçº¿å˜åŒ–ï¼›â‘¡ç†è§£"çº¦æŸå³æ§åˆ¶"â€”â€”ç›¸åŒå‡ ä½•ï¼Œä»…æ”¹å˜è¾¹ç•Œå³å¾—å®Œå…¨ä¸åŒç‰©ç†åœºã€‚</p>
      <hr><span class="hint">âº åˆ‡æ¢3ç§è¾¹ç•Œï¼Œè§‚å¯Ÿæµåœºé‡æ„ï¼Œæ„Ÿå—å®šè§£æ¡ä»¶çš„å†³å®šæ€§ä½œç”¨</span>
    </div>
    <div class="controls">
      <span style="font-size:0.72rem;color:var(--text-dim);">ç‚¹å‡»ç”»å¸ƒæŒ¯å­åŒºåŸŸåˆ‡æ¢è¾¹ç•Œæ¡ä»¶</span>
      <button class="btn orange" id="bcBtn">âŸ³ åˆ‡æ¢è¾¹ç•Œ</button>
    </div>
    <div class="desc" id="desc3">æ¯ä¸ª<strong>è™šçº¿çŸ©å½¢</strong>ä¸ºä¸€ä¸ªå¾®å…ƒæ§åˆ¶ä½“ï¼Œè¾¹ç•Œä¸Šçš„æ§åˆ¶ä½“æ ¹æ®çº¦æŸç±»å‹ç€è‰²ï¼šæ— æ»‘ç§»ï¼ˆè“ï¼‰ã€é€Ÿåº¦å…¥å£ï¼ˆç»¿ï¼‰ã€æ»‘ç§»å£é¢ï¼ˆæ©™ï¼‰ã€‚<br>å†…éƒ¨æ§åˆ¶ä½“ï¼ˆç°ï¼‰é€šè¿‡ç›¸é‚»æ§åˆ¶ä½“è€¦åˆæ±‚è§£ã€‚åˆ‡æ¢è¾¹ç•Œï¼Œæµåœºä¸è¾¹ç•Œç€è‰²åŒæ­¥é‡æ„ã€‚</div>
  </div>

  <!-- LEVEL 4 -->
  <div class="card" id="card-level4">
    <div class="card-header">
      <div class="level-badge level-4">04</div>
      <div><div class="card-title"><i class="fas fa-microscope fa-sm"></i> ç½‘æ ¼è‡ªé€‚åº”ä¸è¯¯å·®ä¿¡ä»»</div><div class="card-subtitle">ç½‘æ ¼æ€»æ•°åˆ†çº§ + å±€éƒ¨ç»†åŒ– + è‡ªé€‚åº”ä¼˜åŒ–</div></div>
      <span class="info-btn" data-popup="popup4" title="ç²¾è®²"><i class="fa-solid fa-lightbulb"></i></span>
      <div class="status-tag" id="status4" style="color:#e74c3c;background:rgba(231,76,60,0.15);border-color:rgba(231,76,60,0.3);">
        <span class="status-dot" style="background:#e74c3c;box-shadow:0 0 8px #e74c3c;"></span><span id="status4txt">156å•å…ƒ</span>
      </div>
    </div>
    <div class="canvas-wrap"><canvas id="canvas4" width="560" height="220"></canvas></div>
    <div class="info-popup" id="popup4">
      <h4><i class="fas fa-microscope"></i> ç¬¬å››å…³Â·ç½‘æ ¼è‡ªé€‚åº”ç²¾è®²</h4>
      <p><strong>è°ƒæ§ç›®æ ‡ï¼š</strong>ç†è§£ç½‘æ ¼å¯†åº¦ä¸æ±‚è§£ç²¾åº¦çš„å…³ç³»ï¼›åœ¨ç‰©ç†é‡æ¢¯åº¦å¤§çš„åŒºåŸŸï¼ˆæŒ¯å­é™„è¿‘ï¼‰å±€éƒ¨åŠ å¯†ï¼›ä½“éªŒåŸºäºè¯¯å·®ä¼°è®¡çš„è‡ªé€‚åº”ç»†åŒ–ã€‚</p>
      <p><strong>æœºç†è§£é‡Šï¼š</strong>FEMè¯¯å·®ä¸å•å…ƒå°ºå¯¸hçš„pæ¬¡æ–¹æˆæ­£æ¯”ã€‚å‡åŒ€åŠ å¯†æµªè´¹ç®—åŠ›ï¼Œè‡ªé€‚åº”ç®—æ³•é€šè¿‡åéªŒè¯¯å·®æŒ‡ç¤ºå™¨è‡ªåŠ¨æ ‡è®°é«˜è¯¯å·®å•å…ƒå¹¶ç»†åŒ–ã€‚çº¢è‰²è™šçº¿åœ†è¡¨ç¤ºç»†åŒ–åŒºåŸŸï¼Œçƒ­åŠ›å›¾æ¨¡æ‹Ÿè¯¯å·®åˆ†å¸ƒã€‚</p>
      <p><strong>èƒ½åŠ›å®ç°ï¼š</strong>â‘ åˆ‡æ¢ä½/ä¸­/é«˜å¯†åº¦ï¼›â‘¡è°ƒèŠ‚ç»†åŒ–åŠå¾„ï¼›â‘¢ç‚¹å‡»ã€è‡ªé€‚åº”ç»†åŒ–ã€‘è‡ªåŠ¨å¼€å¯è¯¯å·®çƒ­åŠ›å›¾ï¼›â‘£æ„ŸçŸ¥"æŠŠç®—åŠ›èŠ±åœ¨åˆ€åˆƒä¸Š"çš„å·¥ç¨‹æ€ç»´ã€‚</p>
      <hr><span class="hint">âº ä¸‰è§’å½¢åŠ å¯†æ˜¾ç¤ºï¼Œçƒ­åŠ›å›¾æ¨¡æ‹Ÿè¯¯å·®ï¼Œè‡ªé€‚åº”æ˜¯å·¥ä¸šä»¿çœŸåˆ©å™¨</span>
    </div>
    <div class="controls">
      <div class="slider-group"><label>ç½‘æ ¼æ€»æ•°</label><input type="range" id="meshDensitySlider" min="0" max="2" value="0" step="1"><span class="val-tag" id="meshDensityVal">156çº§</span></div>
      <div class="slider-group"><label>ç»†åŒ–åŠå¾„</label><input type="range" id="refineRadiusSlider" min="0" max="80" value="40"><span class="val-tag" id="refineRadiusVal">40%</span></div>
      <div class="slider-group"><label>çƒ­åŠ›å›¾</label><input type="range" id="heatmapSlider" min="0" max="100" value="0"><span class="val-tag" id="heatmapVal">å…³</span></div>
      <button class="btn red" id="adaptiveBtn">ğŸ“ è‡ªé€‚åº”ç»†åŒ–</button>
      <button class="btn" id="resetBtn4">â†© é‡ç½®</button>
    </div>
    <div class="desc" id="desc4"><strong>ç½‘æ ¼é¢„ç®—ï¼šä½å¯†åº¦ï¼ˆ156å•å…ƒï¼‰</strong><br>ç»†åŒ–åŠå¾„ <strong>40%</strong>ï¼šçº¢è‰²è™šçº¿åœˆå†…å•å…ƒè‡ªåŠ¨2Ã—2åŠ å¯†ã€‚<br>ç‚¹å‡»<strong>è‡ªé€‚åº”ç»†åŒ–</strong>ï¼Œç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç»†åŒ–åŠå¾„å¹¶å¼€å¯è¯¯å·®çƒ­åŠ›å›¾ã€‚</div>
  </div>

  <!-- LEVEL 5 -->
  <div class="card span-2" id="card-level5">
    <div class="card-header">
      <div class="level-badge level-5">05</div>
      <div><div class="card-title"><i class="fas fa-network-wired fa-sm"></i> å…¨å±€è€¦åˆä¸æœ€ç»ˆæµåœº</div><div class="card-subtitle">ç¦»æ•£â†’è€¦åˆâ†’ç»„è£…â†’æ±‚è§£ï¼šå‰å››å…³å‚æ•°é©±åŠ¨æœ€ç»ˆæµåœº</div></div>
      <span class="info-btn" data-popup="popup5" title="ç²¾è®²"><i class="fa-solid fa-lightbulb"></i></span>
      <div class="status-tag" id="status5" style="color:#9b59b6;background:rgba(155,89,182,0.15);border-color:rgba(155,89,182,0.3);">
        <span class="status-dot" style="background:#9b59b6;box-shadow:0 0 8px #9b59b6;"></span><span id="status5txt">6Ã—4ç½‘æ ¼</span>
      </div>
    </div>
    <div class="canvas-wrap" style="display:flex;justify-content:space-evenly;align-items:flex-start;flex-wrap:wrap;gap:0.5rem;padding:0.8rem;">
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);margin-bottom:0.3rem;font-family:'JetBrains Mono',monospace;">å·¦ï¼šç¦»æ•£å¾®å…ƒè€¦åˆç½‘æ ¼</div><canvas id="canvas5" width="260" height="220"></canvas></div>
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);margin-bottom:0.3rem;font-family:'JetBrains Mono',monospace;">ä¸­ï¼šå…¨å±€åˆšåº¦çŸ©é˜µ [K]</div><canvas id="canvas5mat" width="200" height="200"></canvas></div>
      <div style="text-align:center;"><div style="font-size:0.75rem;color:var(--text-muted);margin-bottom:0.3rem;font-family:'JetBrains Mono',monospace;">å³ï¼šç»¼åˆå‚æ•°æœ€ç»ˆæµåœº</div><canvas id="canvas5flow" width="200" height="200"></canvas></div>
    </div>
    <div class="info-popup" id="popup5">
      <h4><i class="fas fa-network-wired"></i> ç¬¬äº”å…³Â·å…¨å±€è€¦åˆä¸çŸ©é˜µç²¾è®²</h4>
      <p><strong>è°ƒæ§ç›®æ ‡ï¼š</strong>ç†è§£ç¦»æ•£èŠ‚ç‚¹å¦‚ä½•é€šè¿‡è€¦åˆå½¢æˆå…¨å±€çŸ©é˜µ[K]ï¼›è§‚å¯Ÿè€¦åˆèŒƒå›´/å¼ºåº¦å¯¹çŸ©é˜µéé›¶å¸¦å®½åŠæµåœºçš„å½±å“ï¼›æ€»è§ˆå‰å››å…³å‚æ•°å¯¹æœ€ç»ˆæµåœºçš„ç»¼åˆä½œç”¨ã€‚</p>
      <p><strong>æœºç†è§£é‡Šï¼š</strong>FEMå°†å¾®åˆ†æ–¹ç¨‹ç¦»æ•£ä¸º [K]{u}={F}ã€‚å·¦å›¾æ©™è‰²èŠ‚ç‚¹è¿çº¿ä»£è¡¨è€¦åˆå…³ç³»ï¼ˆå½¢å‡½æ•°é‡å ï¼‰ã€‚ä¸­å›¾ä¸ºåˆšåº¦çŸ©é˜µéé›¶æ¨¡å¼ï¼Œå¸¦å®½å–å†³äºè€¦åˆèŒƒå›´ã€‚å³æµåœºæ˜¯é›·è¯ºæ•°ã€è¾¹ç•Œã€ç½‘æ ¼å¯†åº¦ç­‰å…±åŒä½œç”¨çš„ç»“æœã€‚</p>
      <p><strong>èƒ½åŠ›å®ç°ï¼š</strong>â‘ è°ƒæ•´ç½‘æ ¼è¡Œåˆ—ï¼ŒèŠ‚ç‚¹æ•°ä¸çŸ©é˜µç»´æ•°åŒæ­¥ï¼›â‘¡å¢å¤§è€¦åˆèŒƒå›´(1â†’2)çŸ©é˜µå¸¦å®½å¢åŠ ï¼›â‘¢æ”¹å˜å‰å‡ å…³å‚æ•°å³æµåœºå®æ—¶å“åº”â€”â€”æ‰“é€š"å‚æ•°-çŸ©é˜µ-ç‰©ç†åœº"å…¨é“¾è·¯è®¤çŸ¥ã€‚</p>
      <hr><span class="hint">âº è€¦åˆè¿çº¿â‡”çŸ©é˜µéé›¶â‡”æµåœºåˆ†å¸ƒï¼›å¤šç‰©ç†å‚æ•°èåˆ</span>
    </div>
    <div class="controls">
      <div class="slider-group"><label>ç½‘æ ¼åˆ—æ•°</label><input type="range" id="gridColSlider" min="3" max="7" value="6"><span class="val-tag" id="gridColVal">6</span></div>
      <div class="slider-group"><label>ç½‘æ ¼è¡Œæ•°</label><input type="range" id="gridRowSlider" min="2" max="5" value="4"><span class="val-tag" id="gridRowVal">4</span></div>
      <div class="slider-group"><label>è€¦åˆèŒƒå›´</label><input type="range" id="couplingRangeSlider" min="1" max="2" value="1" step="1"><span class="val-tag" id="couplingRangeVal">1 (ç›¸é‚»)</span></div>
      <div class="slider-group"><label>è€¦åˆå¼ºåº¦</label><input type="range" id="couplingStrengthSlider" min="0" max="100" value="70"><span class="val-tag" id="couplingStrengthVal">70%</span></div>
      <div class="slider-group"><label>ç»„è£…è¿›åº¦</label><input type="range" id="assemblyProgressSlider" min="0" max="100" value="100"><span class="val-tag" id="assemblyProgressVal">100%</span></div>
      <button class="btn purple" id="toggleCouplingBtn">ğŸ”— éšè—è¿æ¥</button>
    </div>
    <div class="desc" id="desc5">
      <span style="color:rgba(155,89,182,0.85);">å·¦ï¼šç¦»æ•£å¾®å…ƒè€¦åˆï¼ˆèŠ‚ç‚¹æ©™è‰²ï¼Œè¿çº¿è€¦åˆï¼‰</span>&nbsp;|&nbsp;
      <span style="color:rgba(155,89,182,0.85);">ä¸­ï¼šå…¨å±€çŸ©é˜µ[K]éé›¶æ¨¡å¼</span>&nbsp;|&nbsp;
      <span style="color:rgba(231,76,60,0.85);">å³ï¼šç»¼åˆå‡ ä½•ã€é›·è¯ºæ•°ã€è¾¹ç•Œã€ç½‘æ ¼çš„æœ€ç»ˆæµåœº</span><br>
      å‰å››å…³å‚æ•°å®æ—¶å½±å“å³ä¾§æµåœºï¼š<strong>é›·è¯ºæ•°/ç²˜åº¦ã€è¾¹ç•Œç±»å‹</strong>å…±åŒå†³å®šæœ€ç»ˆæµé€Ÿåˆ†å¸ƒã€‚
    </div>
  </div>

</div>

<button class="eval-float" id="evalBtn">ğŸ“Š èƒ½åŠ›è¯„ä¼°</button>

<div id="evalModal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-close" id="closeModal">Ã—</div>
    <div class="modal-title">ğŸ“‹ æœ‰é™å…ƒæ€ç»´è€ƒæ ¸ Â· äº”å…³ç²¾è¿›æµ‹éªŒ</div>
    <div class="modal-subtitle">è››ç½‘å›¾ = é¢˜ç›®å¾—åˆ†ï¼ˆ50%ï¼Œè“è‰²å®çº¿ï¼‰+ æ“ä½œæ¢ç´¢åº¦ï¼ˆ50%ï¼Œç»¿è‰²è™šçº¿ï¼‰ã€‚å»ºè®®å…ˆè°ƒæ§å„å…³å¡å‚æ•°å†æäº¤ã€‚</div>
    <div class="quiz-grid">
      <div class="quiz-left">
        <div id="quizContainer"></div>
        <button id="submitQuizBtn" class="btn-eval">âœ… æäº¤è¯„æµ‹ Â· ç”Ÿæˆèƒ½åŠ›å›¾è°±</button>
      </div>
      <div class="quiz-right">
        <canvas id="radarCanvas" width="240" height="240"></canvas>
        <div class="radar-legend">
          <span><i class="legend-dot-q"></i>é¢˜ç›®å¾—åˆ†</span>
          <span><i class="legend-dot-i"></i>æ“ä½œæ¢ç´¢</span>
        </div>
        <div class="total-score-display" id="totalScoreDisplay">â€” / 100</div>
        <div class="score-bar"><div class="score-fill" id="scoreFill" style="width:0%"></div></div>
        <div class="engineer-level" id="engineerLevel">å¾…è¯„æµ‹</div>
        <div class="advice-text" id="adviceText">å®Œæˆäº”é“é€‰æ‹©é¢˜å¹¶è°ƒæ§å„å…³å¡å‚æ•°åæäº¤ï¼Œè·å¾—<strong>åŒç»´åº¦äº”è½´èƒ½åŠ›é›·è¾¾å›¾</strong>ä¸ä¸“å±æå‡å»ºè®®ã€‚</div>
        <div class="interact-scores" id="interactScores" style="display:none;"></div>
      </div>
    </div>
  </div>
</div>

<footer>
      <p style="font-size: 0.8rem; font-weight: bold; margin-bottom: 15px; color: #ffffff;">
        ğŸ’§ æœ‰é™å…ƒä»¿çœŸæ€ç»´è®­ç»ƒ - å·¥ç¨‹ä¼ é€’ç°è±¡æ•™å­¦å¹³å° Â© 2025 | 2å‡åŠ æ¹¿å™¨æ•™å­¦æ¼”ç¤º | ç‰ˆæœ¬ 1.0 |
      <style="margin-bottom: 8px; color: #cbd5e1;">
        <strong>é‚®ç®±:</strong> xgyanger@qq.com
    </p>
      <p style="margin-top:0.3rem;">æ‰€æœ‰æµåœºå¯è§†åŒ–å‡ä¸ºç¤ºæ„æ€§ä¼ªç‰©ç†ç®—æ³•ï¼Œä¸ä»£è¡¨çœŸå®æ•°å€¼ä»¿çœŸç»“æœ</p>
    <div style="margin-top: 10px;">
        <span style="color: #ffcc00; font-weight: bold; font-size: 0.6rem;">
            ç‰ˆæƒÂ©2025 AIknow. ä¿ç•™æ‰€æœ‰æƒåˆ© | Copyright Â©2025 AIknow. All rights reserved.
        </span>
</footer>

<script>
// ============================================================
// GLOBAL UTILITIES
// ============================================================
function arrow(ctx,x1,y1,x2,y2,color,lw){
  lw=lw||1.2; ctx.strokeStyle=color; ctx.lineWidth=lw;
  ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.stroke();
  const a=Math.atan2(y2-y1,x2-x1),hs=4+lw;
  ctx.fillStyle=color; ctx.beginPath(); ctx.moveTo(x2,y2);
  ctx.lineTo(x2-hs*Math.cos(a-0.4),y2-hs*Math.sin(a-0.4));
  ctx.lineTo(x2-hs*Math.cos(a+0.4),y2-hs*Math.sin(a+0.4));
  ctx.closePath(); ctx.fill();
}
if(!CanvasRenderingContext2D.prototype.roundRect){
  CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){
    if(w<2*r)r=w/2; if(h<2*r)r=h/2;
    this.moveTo(x+r,y); this.lineTo(x+w-r,y);
    this.quadraticCurveTo(x+w,y,x+w,y+r); this.lineTo(x+w,y+h-r);
    this.quadraticCurveTo(x+w,y+h,x+w-r,y+h); this.lineTo(x+r,y+h);
    this.quadraticCurveTo(x,y+h,x,y+h-r); this.lineTo(x,y+r);
    this.quadraticCurveTo(x,y,x+r,y); return this;
  };
}

// ============================================================
// INTERACTION TRACKER  (æ“ä½œæ¢ç´¢åº¦, æ¯ç»´åº¦ 0-20)
// ============================================================
const interact = {
  lv1: { simplified:false, rotChanged:false, wlChanged:false, depChanged:false, alphaChanged:false },
  lv2: { reBuckets:new Set(), muChanged:false },
  lv3: { modesVisited:new Set([0]) },
  lv4: { densityChanged:false, refineChanged:false, heatUsed:false, adaptiveClicked:false },
  lv5: { colChanged:false, rowChanged:false, rangeChanged:false, strengthChanged:false, progressChanged:false },
  addRe(re){ this.lv2.reBuckets.add(Math.floor(re/10)); },
  score(){
    const s1 = Math.min(20,
      (this.lv1.simplified?5:0)+(this.lv1.rotChanged?4:0)+
      (this.lv1.wlChanged?4:0)+(this.lv1.depChanged?3:0)+(this.lv1.alphaChanged?4:0));
    const rb = this.lv2.reBuckets.size;
    const s2 = Math.min(20,(rb<3?3:rb<6?8:rb<9?14:18)+(this.lv2.muChanged?2:0));
    const mv = this.lv3.modesVisited.size;
    const s3 = Math.min(20, mv===1?4 : mv===2?12 : 20);
    const s4 = Math.min(20,
      (this.lv4.densityChanged?5:0)+(this.lv4.refineChanged?5:0)+
      (this.lv4.heatUsed?5:0)+(this.lv4.adaptiveClicked?5:0));
    const s5 = Math.min(20,
      (this.lv5.colChanged?4:0)+(this.lv5.rowChanged?4:0)+(this.lv5.rangeChanged?4:0)+
      (this.lv5.strengthChanged?4:0)+(this.lv5.progressChanged?4:0));
    return [s1,s2,s3,s4,s5];
  }
};

// ============================================================
// LEVEL 1
// ============================================================
(function(){
  const canvas=document.getElementById('canvas1'),ctx=canvas.getContext('2d'),W=canvas.width,H=canvas.height;
  const tooltip=document.getElementById('tooltip1');
  let simplified=false,alpha3d=0.7,rot=22,depth=28,waterLevel=0.67,animating=false;
  const rotSlider=document.getElementById('rotSlider'),depSlider=document.getElementById('depSlider'),
        wlSlider=document.getElementById('wlSlider'),alphaSlider=document.getElementById('alphaSlider');
  function updateVals(){
    document.getElementById('rotVal').textContent=rotSlider.value+'Â°';
    document.getElementById('depVal').textContent=depSlider.value;
    document.getElementById('wlVal').textContent=wlSlider.value+'%';
    document.getElementById('alphaVal').textContent=(alphaSlider.value/100).toFixed(2);
  }
  rotSlider.addEventListener('input',function(){rot=+this.value;updateVals();interact.lv1.rotChanged=true;if(!animating)drawAll();});
  depSlider.addEventListener('input',function(){depth=+this.value;updateVals();interact.lv1.depChanged=true;if(!animating)drawAll();});
  wlSlider.addEventListener('input',function(){waterLevel=+this.value/100;updateVals();interact.lv1.wlChanged=true;if(!animating)drawAll();});
  alphaSlider.addEventListener('input',function(){alpha3d=+this.value/100;updateVals();interact.lv1.alphaChanged=true;if(!animating)drawAll();});
  function drawAll(){
    ctx.clearRect(0,0,W,H);
    ctx.save();ctx.globalAlpha=alpha3d*(simplified?0.22:1);
    const ox=28,oy=38,bw=100,bh=140,bd=depth*0.5;
    const sina=Math.sin(rot*Math.PI/180)*depth*0.012,cosa=Math.cos(rot*Math.PI/180);
    function proj(i,j,k){return{x:ox+40+i*cosa+k*0.6,y:oy+bh-j+(k*0.35-i*sina*0.25)};}
    const ftl=proj(0,bh,0),ftr=proj(bw,bh,0),fbr=proj(bw,0,0),fbl=proj(0,0,0);
    const btl=proj(0,bh,bd),btr=proj(bw,bh,bd),bbr=proj(bw,0,bd),bbl=proj(0,0,bd);
    ctx.fillStyle='rgba(20,60,140,0.12)';ctx.strokeStyle='rgba(47,140,255,0.3)';ctx.lineWidth=0.7;
    ctx.beginPath();ctx.moveTo(btl.x,btl.y);ctx.lineTo(btr.x,btr.y);ctx.lineTo(bbr.x,bbr.y);ctx.lineTo(bbl.x,bbl.y);ctx.closePath();ctx.fill();ctx.stroke();
    ctx.fillStyle='rgba(30,80,170,0.14)';ctx.beginPath();ctx.moveTo(ftl.x,ftl.y);ctx.lineTo(btl.x,btl.y);ctx.lineTo(bbl.x,bbl.y);ctx.lineTo(fbl.x,fbl.y);ctx.closePath();ctx.fill();ctx.stroke();
    ctx.fillStyle='rgba(25,70,160,0.18)';ctx.beginPath();ctx.moveTo(ftr.x,ftr.y);ctx.lineTo(btr.x,btr.y);ctx.lineTo(bbr.x,bbr.y);ctx.lineTo(fbr.x,fbr.y);ctx.closePath();ctx.fill();ctx.stroke();
    ctx.fillStyle='rgba(56,189,248,0.15)';ctx.strokeStyle='rgba(47,140,255,0.5)';ctx.lineWidth=1.2;
    ctx.beginPath();ctx.moveTo(ftl.x,ftl.y);ctx.lineTo(ftr.x,ftr.y);ctx.lineTo(fbr.x,fbr.y);ctx.lineTo(fbl.x,fbl.y);ctx.closePath();ctx.fill();ctx.stroke();
    ctx.fillStyle='rgba(100,180,255,0.12)';ctx.strokeStyle='rgba(47,140,255,0.3)';ctx.lineWidth=0.8;
    ctx.beginPath();ctx.moveTo(ftl.x,ftl.y);ctx.lineTo(ftr.x,ftr.y);ctx.lineTo(btr.x,btr.y);ctx.lineTo(btl.x,btl.y);ctx.closePath();ctx.fill();ctx.stroke();
    const wfl=proj(2,0,0),wfr=proj(bw-2,0,0),wflt=proj(2,bh*waterLevel,0);
    ctx.fillStyle='rgba(47,140,255,0.32)';
    ctx.beginPath();ctx.moveTo(wfl.x,wfl.y);ctx.lineTo(wfr.x,wfr.y);ctx.lineTo(proj(bw-2,bh*waterLevel,0).x,proj(bw-2,bh*waterLevel,0).y);ctx.lineTo(wflt.x,wflt.y);ctx.closePath();ctx.fill();
    ctx.fillStyle='rgba(100,116,139,0.7)';ctx.beginPath();ctx.ellipse(proj(bw*0.3,bh,0).x,proj(bw*0.3,bh,0).y-2,7,3,0,0,Math.PI*2);ctx.fill();
    const tcx=(fbl.x+fbr.x)/2,tcy=fbl.y;
    ctx.fillStyle='rgba(80,100,130,0.7)';ctx.beginPath();ctx.ellipse(tcx,tcy,16,6,0,Math.PI,Math.PI*2);ctx.fill();
    ctx.strokeStyle='rgba(47,140,255,0.5)';ctx.lineWidth=1;ctx.stroke();
    ctx.fillStyle='rgba(47,140,255,1)';ctx.font='600 9px JetBrains Mono,monospace';ctx.fillText('æ°´ä½ '+Math.round(waterLevel*100)+'%',wflt.x-2,wflt.y-5);
    ctx.fillStyle='rgba(150,175,196,1)';ctx.font='10px sans-serif';ctx.fillText('æ³¨æ°´å£',proj(bw*0.3,bh,0).x-12,proj(bw*0.3,bh,0).y-12);ctx.fillText('æŒ¯å­',tcx-12,tcy+14);
    ctx.fillStyle='rgba(47,140,255,0.75)';ctx.font='bold 10px sans-serif';ctx.fillText('2L',ox+50,oy+14);
    ctx.restore();
    ctx.globalAlpha=Math.min(1,alpha3d+0.2);ctx.fillStyle='rgba(47,140,255,0.7)';ctx.font='bold 22px Arial';ctx.fillText('â†’',W*0.48,H/2+6);
    ctx.font='500 9px Noto Sans SC';ctx.fillStyle='rgba(150,175,196,0.5)';ctx.fillText('ç®€åŒ–',W*0.478,H/2+21);ctx.globalAlpha=1;
    draw2D(ctx,W*0.5+8,H,waterLevel,simplified);
  }
  function draw2D(ctx,rx,H,wl,highlight){
    const pw=130,ph=160,py=25,px=rx;
    ctx.fillStyle=highlight?'rgba(47,140,255,1)':'rgba(150,175,196,0.4)';ctx.font=(highlight?'700':'500')+' 12px Noto Sans SC';ctx.fillText('2D è½´å¯¹ç§°æˆªé¢',px,17);
    ctx.fillStyle='rgba(47,140,255,0.3)';ctx.fillRect(px+18,py+ph*(1-wl),pw-18,ph*wl-20);
    ctx.strokeStyle=highlight?'rgba(47,140,255,0.8)':'rgba(150,175,196,0.5)';ctx.lineWidth=highlight?2:1.2;ctx.strokeRect(px+18,py,pw-18,ph);
    ctx.setLineDash([4,3]);ctx.strokeStyle='rgba(231,76,60,0.6)';ctx.lineWidth=1.2;ctx.beginPath();ctx.moveTo(px+18,py-6);ctx.lineTo(px+18,py+ph+6);ctx.stroke();ctx.setLineDash([]);
    ctx.save();ctx.translate(px+13,py+ph/2);ctx.rotate(-Math.PI/2);ctx.fillStyle='rgba(231,76,60,0.95)';ctx.font='10px Noto Sans SC';ctx.fillText('å¯¹ç§°è½´',-20,0);ctx.restore();
    const tcx2=px+18+(pw-18)*0.5,tcy2=py+ph;
    ctx.fillStyle='rgba(80,100,130,0.6)';ctx.beginPath();ctx.arc(tcx2,tcy2,18,Math.PI,2*Math.PI);ctx.fill();
    ctx.strokeStyle=highlight?'rgba(47,140,255,0.7)':'rgba(150,175,196,0.5)';ctx.lineWidth=1.2;ctx.stroke();
    const wly2=py+ph-ph*wl+20;ctx.setLineDash([3,3]);ctx.strokeStyle='rgba(47,140,255,0.4)';ctx.lineWidth=0.9;
    ctx.beginPath();ctx.moveTo(px+18,wly2);ctx.lineTo(px+pw,wly2);ctx.stroke();ctx.setLineDash([]);
    ctx.fillStyle='rgba(47,140,255,1)';ctx.font='9px Noto Sans SC';ctx.fillText('æ°´ä½ '+Math.round(wl*100)+'%',px+18+(pw-18)*0.6-8,wly2-4);
    ctx.fillStyle='rgba(47,140,255,0.7)';ctx.font='bold 10px JetBrains Mono';ctx.fillText('2L',px+18+(pw-18)*0.5-10,py+17);
    ctx.fillStyle='rgba(150,175,196,1)';ctx.font='10px Noto Sans SC';ctx.fillText('æŒ¯å­',tcx2-10,tcy2+15);ctx.fillText('å£é¢',px+pw-6,py+ph/2);
    if(highlight){ctx.strokeStyle='rgba(47,140,255,0.3)';ctx.lineWidth=7;ctx.strokeRect(px+14,py-4,pw-10,ph+8);}
  }
  canvas.addEventListener('mousemove',function(e){
    const rect=canvas.getBoundingClientRect(),sx=canvas.width/rect.width,sy=canvas.height/rect.height;
    const mx=(e.clientX-rect.left)*sx,my=(e.clientY-rect.top)*sy;
    const rx=W*0.5+8,px=rx,py=25,pw=130,ph=160,tcx=px+18+(pw-18)*0.5,tcy=py+ph;
    if(Math.sqrt((mx-tcx)**2+(my-tcy)**2)<=20&&my>=tcy-8){tooltip.style.display='block';tooltip.style.left=(e.clientX-rect.left+10)+'px';tooltip.style.top=(e.clientY-rect.top-28)+'px';canvas.style.cursor='pointer';}
    else{tooltip.style.display='none';canvas.style.cursor='default';}
  });
  canvas.addEventListener('mouseleave',()=>tooltip.style.display='none');
  document.getElementById('simplifyBtn').addEventListener('click',function(){
    if(animating)return;animating=true;simplified=true;interact.lv1.simplified=true;let start=null;
    (function step(ts){if(!start)start=ts;const p=Math.min((ts-start)/600,1);alpha3d=1-p*0.7;drawAll();
      if(p<1)requestAnimationFrame(step);else{animating=false;document.getElementById('status1txt').textContent='å·²ç®€åŒ–ä¸º2D';
      document.getElementById('desc1').innerHTML='<strong>âœ… å·²å¿½ç•¥å€’è§’ã€ç®¡è·¯ï¼Œé™ç»´ä¸º2Dè½´å¯¹ç§°ï¼</strong><br>å³ä¾§é«˜äº®æˆªé¢ä¿ç•™äº†æŒ¯å­é©±åŠ¨åŒºåŸŸã€æ°´ç®±è¾¹ç•Œã€æ°´ä½ç­‰å…³é”®å‡ ä½•ç‰¹å¾ã€‚';}
    })(performance.now());
  });
  document.getElementById('resetBtn1').addEventListener('click',function(){
    simplified=false;alpha3d=0.7;rotSlider.value=22;rot=22;depSlider.value=28;depth=28;wlSlider.value=67;waterLevel=0.67;alphaSlider.value=70;
    updateVals();document.getElementById('status1txt').textContent='3DÂ·2Då¯¹æ¯”';
    document.getElementById('desc1').innerHTML='å®é™…åŠ æ¹¿å™¨åŒ…å«è®¸å¤šå¾®å°ç‰¹å¾ã€‚æœ‰é™å…ƒç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­å“ªäº›ç‰¹å¾å½±å“åŠ›å­¦è¡Œä¸ºï¼Œå°†<strong>3Dç®€åŒ–ä¸º2Dè½´å¯¹ç§°</strong>ï¼Œè®¡ç®—é‡å‡å°‘ <strong>90%</strong> ä»¥ä¸Šã€‚<br>æ‹–æ‹½æ»‘å—è°ƒèŠ‚ä¸‰ç»´è§†è§’/æ°´ä½/é€æ˜åº¦ï¼Œç‚¹å‡»ã€ä¸€é”®ç®€åŒ–ã€‘è§‚å¯Ÿé™ç»´è¿‡ç¨‹ã€‚';
    drawAll();
  });
  updateVals();drawAll();
})();

// ============================================================
// LEVEL 2
// ============================================================
(function(){
  const canvas=document.getElementById('canvas2'),ctx=canvas.getContext('2d'),W=canvas.width,H=canvas.height;
  const BOX={x:60,y:20,w:440,h:180},TCX=BOX.x+BOX.w*0.5,TCY=BOX.y+BOX.h,TR=22;
  let t=0;
  function flowVec(x,y,re,mu,time){
    const nx=(x-BOX.x)/BOX.w-0.5,ny=(y-BOX.y)/BOX.h;
    const d=Math.sqrt(nx*nx+(ny-1)**2);
    const bx=nx*0.8/(d+0.3),by=-1.2/(d+0.2);
    const turb=Math.max(0,(re-30)/70);
    const px2=Math.sin(nx*6+time*1.5+ny*4)*turb*1.5/mu;
    const py2=Math.cos(ny*5+time*1.2+nx*3)*turb*1.2/mu;
    return{vx:(bx+px2)*0.6,vy:(by+py2)*0.6};
  }
  function drawFlow(){
    const re=+document.getElementById('reSlider').value,mu=+document.getElementById('muSlider').value/10;
    ctx.clearRect(0,0,W,H);
    ctx.fillStyle='rgba(5,15,35,0.7)';ctx.fillRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.strokeStyle='rgba(47,140,255,0.5)';ctx.lineWidth=1.8;ctx.strokeRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.fillStyle='rgba(60,80,110,0.7)';ctx.beginPath();ctx.arc(TCX,TCY,TR,Math.PI,2*Math.PI);ctx.fill();
    ctx.strokeStyle='rgba(47,140,255,0.4)';ctx.lineWidth=1.3;ctx.stroke();
    ctx.fillStyle='rgba(150,175,196,0.45)';ctx.font='9px Noto Sans SC';ctx.fillText('æŒ¯å­',TCX-10,TCY+15);
    ctx.setLineDash([4,3]);ctx.strokeStyle='rgba(231,76,60,0.4)';ctx.lineWidth=1;
    ctx.beginPath();ctx.moveTo(BOX.x,BOX.y-5);ctx.lineTo(BOX.x,BOX.y+BOX.h+5);ctx.stroke();ctx.setLineDash([]);
    const gx=14,gy=9,dx=BOX.w/(gx+1),dy=BOX.h/(gy+1),turb=Math.max(0,(re-30)/70),arLen=14+turb*6;
    for(let i=1;i<=gx;i++){
      for(let j=1;j<=gy;j++){
        const px=BOX.x+i*dx,py=BOX.y+j*dy;
        if(Math.sqrt((px-TCX)**2+(py-TCY)**2)<TR)continue;
        ctx.strokeStyle='rgba(47,140,255,0.42)';ctx.lineWidth=0.7;ctx.setLineDash([2,2]);
        ctx.strokeRect(px-dx/2+2,py-dy/2+2,dx-4,dy-4);ctx.setLineDash([]);
        const{vx,vy}=flowVec(px,py,re,mu,t),mag=Math.sqrt(vx*vx+vy*vy);if(mag<0.001)continue;
        const nvx=vx/mag,nvy=vy/mag,ex=px+nvx*arLen,ey=py+nvy*arLen,spd=Math.min(1,mag*1.5);
        const col=`rgb(${Math.round(30+spd*160)},${Math.round(100+spd*80)},${Math.round(255-spd*80)})`;
        ctx.strokeStyle=col;ctx.lineWidth=1.1;ctx.beginPath();ctx.moveTo(px,py);ctx.lineTo(ex,ey);ctx.stroke();
        const ang=Math.atan2(nvy,nvx);ctx.fillStyle=col;ctx.beginPath();ctx.moveTo(ex,ey);
        ctx.lineTo(ex-5*Math.cos(ang-0.4),ey-5*Math.sin(ang-0.4));ctx.lineTo(ex-5*Math.cos(ang+0.4),ey-5*Math.sin(ang+0.4));ctx.closePath();ctx.fill();
      }
    }
    const reColor=re<40?'#2ecc71':re<70?'#f39c12':'#e74c3c';
    ctx.fillStyle=reColor;ctx.font='700 11px JetBrains Mono';ctx.fillText('Re = '+re,BOX.x+BOX.w-68,BOX.y+18);
    ctx.fillStyle='rgba(150,175,196,0.5)';ctx.font='9px Noto Sans SC';ctx.fillText('Î¼ = '+mu.toFixed(1),BOX.x+BOX.w-68,BOX.y+32);
    t+=0.04;interact.addRe(re);
    document.getElementById('reVal').textContent=re;document.getElementById('muVal').textContent=mu.toFixed(1);
    document.getElementById('status2txt').textContent='Re â‰ˆ '+re;
    const regime=re<40?'å±‚æµï¼ˆå¹³æ»‘ï¼‰':re<70?'è¿‡æ¸¡æµ':'æ¹æµï¼ˆæ¶¡æ—‹ï¼‰';
    const dom=re<40?'<strong>ç²˜æ€§åŠ›ä¸»å¯¼</strong> â†’ å¹³æ»‘å±‚æµã€‚':re<70?'æƒ¯æ€§åŠ›ä¸ç²˜æ€§åŠ›<strong>ç›¸äº’ç«äº‰</strong> â†’ è¿‡æ¸¡æµã€‚':'<strong>æƒ¯æ€§åŠ›ä¸»å¯¼</strong> â†’ å¤æ‚æ¶¡æ—‹ï¼Œæµçº¿ç´Šä¹±ã€‚';
    document.getElementById('desc2').innerHTML='<div class="equation">Ï (<span class="eq-red">âˆ‚u/âˆ‚t + uÂ·âˆ‡u</span>) = -âˆ‡p + <span class="eq-blue">Î¼âˆ‡Â²u</span> + f</div><span class="eq-red">â–  æƒ¯æ€§é¡¹</span> &nbsp;<span class="eq-blue">â–  ç²˜æ€§é¡¹</span><br>å½“å‰ <strong>Re â‰ˆ '+re+'</strong>ï¼Œæµæ€ï¼š<strong>'+regime+'</strong>ã€‚'+dom+'<br><span style="color:rgba(47,140,255,0.55);">è™šçº¿çŸ©å½¢ï¼šæ¯ä¸ªå¾®å…ƒæ§åˆ¶ä½“è¾¹ç•Œã€‚</span>';
    requestAnimationFrame(drawFlow);
  }
  document.getElementById('muSlider').addEventListener('input',()=>interact.lv2.muChanged=true);
  drawFlow();
})();

// ============================================================
// LEVEL 3
// ============================================================
(function(){
  const canvas=document.getElementById('canvas3'),ctx=canvas.getContext('2d'),W=canvas.width,H=canvas.height;
  const modes=[
    {name:'æ— æ»‘ç§»å£é¢',color:'#2f8cff',bg:'rgba(47,140,255,0.15)',bbc:'rgba(47,140,255,0.3)',flow:'still'},
    {name:'é€Ÿåº¦å…¥å£',color:'#2ecc71',bg:'rgba(46,204,113,0.15)',bbc:'rgba(46,204,113,0.3)',flow:'inlet'},
    {name:'æ»‘ç§»å£é¢',color:'#f39c12',bg:'rgba(243,156,18,0.15)',bbc:'rgba(243,156,18,0.3)',flow:'slip'},
  ];
  let modeIdx=0,animT=0;
  const BOX={x:60,y:20,w:440,h:165},TCX=BOX.x+BOX.w*0.5,TCY=BOX.y+BOX.h,TR=24;
  function getArrows(flow,t){
    const arr=[],gx=11,gy=7,dx=BOX.w/(gx+1),dy=BOX.h/(gy+1);
    for(let i=1;i<=gx;i++){for(let j=1;j<=gy;j++){
      const px=BOX.x+i*dx,py=BOX.y+j*dy;if(Math.sqrt((px-TCX)**2+(py-TCY)**2)<TR+5)continue;
      const nx=(px-TCX)/(BOX.w/2),ny=(py-BOX.y)/BOX.h;let vx=0,vy=0,mag=0;
      if(flow==='still'){vx=Math.sin(nx*3+t*0.5)*0.08;vy=-Math.abs(Math.cos(ny*2+t*0.4))*0.1;mag=0.12;}
      else if(flow==='inlet'){const d=Math.sqrt(nx*nx+(ny-1)**2);vx=nx*0.5/(d+0.3)+Math.sin(t*1.5+ny*3)*0.2;vy=-1.2/(d+0.15)*(1-ny*0.5)+Math.cos(t*1.2+nx*2)*0.15;mag=Math.sqrt(vx*vx+vy*vy);vx/=mag;vy/=mag;mag=0.7+ny*0.5;}
      else{const cx=(px-BOX.x-BOX.w/2)/(BOX.w/2);vx=-Math.sin(ny*Math.PI)*0.9+Math.sin(t*0.8+nx*2)*0.25;vy=Math.cos(cx*Math.PI*0.6)*0.3+Math.sin(t*0.6+ny*3)*0.2;mag=Math.sqrt(vx*vx+vy*vy);if(mag>0){vx/=mag;vy/=mag;}mag=0.5+Math.abs(cx)*0.4;}
      const isLeftWall=i===1,isRightWall=i===gx,isTopWall=j===1,isBottomWall=j===gy;
      const nearTrans=Math.sqrt((px-TCX)**2+(py-TCY)**2)<TR*2.2&&isBottomWall;
      arr.push({px,py,vx,vy,mag,isLeftWall,isRightWall,isTopWall,isBottomWall,nearTrans});
    }}return arr;
  }
  function draw(){
    const m=modes[modeIdx];ctx.clearRect(0,0,W,H);
    ctx.fillStyle='rgba(4,10,22,0.75)';ctx.fillRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.strokeStyle='rgba(47,140,255,0.45)';ctx.lineWidth=1.8;ctx.strokeRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.setLineDash([4,3]);ctx.strokeStyle='rgba(231,76,60,0.4)';ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(BOX.x,BOX.y-5);ctx.lineTo(BOX.x,BOX.y+BOX.h+5);ctx.stroke();ctx.setLineDash([]);
    const gx=11,gy=7,dx=BOX.w/(gx+1),dy=BOX.h/(gy+1);
    getArrows(m.flow,animT).forEach(({px,py,vx,vy,mag,isLeftWall,isRightWall,isTopWall,isBottomWall,nearTrans})=>{
      const isBound=isLeftWall||isRightWall||isTopWall||isBottomWall||nearTrans;
      let cc='rgba(47,140,255,0.07)',bc='rgba(47,140,255,0.15)',bw=0.6;
      if(isBound){if(nearTrans){cc=m.flow==='inlet'?'rgba(46,204,113,0.22)':m.flow==='slip'?'rgba(243,156,18,0.22)':'rgba(47,140,255,0.22)';bc=m.flow==='inlet'?'rgba(46,204,113,0.6)':m.flow==='slip'?'rgba(243,156,18,0.6)':'rgba(47,140,255,0.6)';}
        else if(isLeftWall){cc='rgba(231,76,60,0.15)';bc='rgba(231,76,60,0.45)';}
        else{cc=m.flow==='still'?'rgba(47,140,255,0.2)':m.flow==='inlet'?'rgba(46,204,113,0.15)':'rgba(243,156,18,0.18)';bc=m.flow==='still'?'rgba(47,140,255,0.5)':m.flow==='inlet'?'rgba(46,204,113,0.45)':'rgba(243,156,18,0.45)';}bw=1.4;}
      ctx.fillStyle=cc;ctx.fillRect(px-dx/2+1,py-dy/2+1,dx-2,dy-2);
      ctx.strokeStyle=bc;ctx.lineWidth=bw;ctx.setLineDash([2,2]);ctx.strokeRect(px-dx/2+1,py-dy/2+1,dx-2,dy-2);ctx.setLineDash([]);
      const len=8+mag*4,ex=px+vx*len,ey=py+vy*len;
      ctx.globalAlpha=isBound?0.9:0.65;arrow(ctx,px-vx*len*0.4,py-vy*len*0.4,ex,ey,isBound?m.color:'rgba(47,140,255,0.5)',isBound?1.3:0.9);ctx.globalAlpha=1;
    });
    ctx.fillStyle=m.color+'33';ctx.strokeStyle=m.color;ctx.lineWidth=2.5;ctx.beginPath();ctx.arc(TCX,TCY,TR,Math.PI,2*Math.PI);ctx.fill();ctx.stroke();
    ctx.fillStyle='rgba(150,175,196,0.4)';ctx.font='11px Noto Sans SC';ctx.fillText('æŒ¯å­',TCX-10,TCY+16);
    ctx.fillStyle=m.color+'bb';ctx.beginPath();ctx.roundRect(BOX.x+6,BOX.y+6,116,21,6);ctx.fill();
    ctx.fillStyle='rgba(255,255,255,1)';ctx.font='500 12px ';ctx.fillText('è¾¹ç•Œ: '+m.name,BOX.x+14,BOX.y+20);
    animT+=0.05;requestAnimationFrame(draw);
  }
  function updateStatus(){
    const m=modes[modeIdx];
    document.getElementById('status3txt').textContent=m.name;document.getElementById('bc-dot').style.background=m.color;document.getElementById('bc-dot').style.boxShadow='0 0 8px '+m.color;
    const st3=document.getElementById('status3');st3.style.color=m.color;st3.style.background=m.bg;st3.style.borderColor=m.bbc;
    const descs={still:'æ¯ä¸ª<strong>è™šçº¿çŸ©å½¢</strong>ä¸ºä¸€ä¸ªå¾®å…ƒæ§åˆ¶ä½“ã€‚å½“å‰ï¼š<strong>æ— æ»‘ç§»å£é¢</strong>â€”â€”æµé€Ÿåœ¨å£é¢ä¸ºé›¶ï¼Œæƒ¯æ€§æå°ã€‚',inlet:'å½“å‰ï¼š<strong>é€Ÿåº¦å…¥å£</strong>â€”â€”æŒ¯å­é™„è¿‘æ§åˆ¶ä½“ï¼ˆç»¿è‰²ï¼‰è¢«è®¾ä¸ºé€Ÿåº¦è¿›å£ï¼Œæ°´ä»åº•éƒ¨å–·æ¶Œå‘ä¸Šå½¢æˆä¸Šå‡æµã€‚',slip:'å½“å‰ï¼š<strong>æ»‘ç§»å£é¢</strong>â€”â€”åº•éƒ¨æ§åˆ¶ä½“ï¼ˆæ©™è‰²ï¼‰å…è®¸åˆ‡å‘æµåŠ¨ï¼Œå½¢æˆå¤§èŒƒå›´å›æµç¯ã€‚ä¸åŒè¾¹ç•Œäº§ç”Ÿå®Œå…¨ä¸åŒçš„æµåœºã€‚'};
    document.getElementById('desc3').innerHTML=descs[m.flow];
  }
  function nextMode(){modeIdx=(modeIdx+1)%modes.length;interact.lv3.modesVisited.add(modeIdx);updateStatus();}
  canvas.addEventListener('click',function(e){
    const rect=canvas.getBoundingClientRect(),sx=canvas.width/rect.width,sy=canvas.height/rect.height;
    const mx=(e.clientX-rect.left)*sx,my=(e.clientY-rect.top)*sy;
    if(my>=TCY-TR-10&&my<=TCY+TR+20&&mx>=TCX-50&&mx<=TCX+50)nextMode();
  });
  document.getElementById('bcBtn').addEventListener('click',nextMode);
  draw();updateStatus();
})();

// ============================================================
// LEVEL 4
// ============================================================
(function(){
  const canvas=document.getElementById('canvas4'),ctx=canvas.getContext('2d'),W=canvas.width,H=canvas.height;
  const BOX={x:60,y:15,w:440,h:180},TCX=BOX.x+BOX.w*0.5,TCY=BOX.y+BOX.h,TR=22;
  const CONFIGS=[{baseNx:6,baseNy:4},{baseNx:12,baseNy:8},{baseNx:24,baseNy:16}];
  let densityLevel=0,refineRadius=40,heatAlpha=0;
  const meshSlider=document.getElementById('meshDensitySlider'),refineSlider=document.getElementById('refineRadiusSlider'),heatSlider=document.getElementById('heatmapSlider');
  meshSlider.addEventListener('input',function(){densityLevel=+this.value;const lbs=['156çº§','600çº§','3000çº§'];document.getElementById('meshDensityVal').textContent=lbs[densityLevel];interact.lv4.densityChanged=true;drawMesh();});
  refineSlider.addEventListener('input',function(){refineRadius=+this.value;document.getElementById('refineRadiusVal').textContent=refineRadius+'%';interact.lv4.refineChanged=true;drawMesh();});
  heatSlider.addEventListener('input',function(){const v=+this.value;heatAlpha=v/100;document.getElementById('heatmapVal').textContent=v===0?'å…³':v+'%';if(v>0)interact.lv4.heatUsed=true;drawMesh();});
  document.getElementById('adaptiveBtn').addEventListener('click',function(){
    refineRadius=densityLevel===0?55:densityLevel===1?48:42;refineSlider.value=refineRadius;document.getElementById('refineRadiusVal').textContent=refineRadius+'%';
    heatSlider.value=80;heatAlpha=0.8;document.getElementById('heatmapVal').textContent='80%';
    interact.lv4.adaptiveClicked=true;interact.lv4.heatUsed=true;drawMesh();
  });
  document.getElementById('resetBtn4').addEventListener('click',function(){
    meshSlider.value=0;densityLevel=0;document.getElementById('meshDensityVal').textContent='156çº§';
    refineSlider.value=40;refineRadius=40;document.getElementById('refineRadiusVal').textContent='40%';
    heatSlider.value=0;heatAlpha=0;document.getElementById('heatmapVal').textContent='å…³';drawMesh();
  });
  function genMesh(cfg,refRad){
    const tris=[],dx=BOX.w/cfg.baseNx,dy=BOX.h/cfg.baseNy,refDist=(refRad/100)*BOX.h*0.9;
    for(let i=0;i<cfg.baseNx;i++){for(let j=0;j<cfg.baseNy;j++){
      const x0=BOX.x+i*dx,y0=BOX.y+j*dy,x1=x0+dx,y1=y0+dy;
      const cx=(x0+x1)/2,cy=(y0+y1)/2;
      if(Math.sqrt((cx-TCX)**2+(cy-TCY)**2)<refDist){
        const mx=(x0+x1)/2,my=(y0+y1)/2;
        tris.push([[x0,y0],[mx,y0],[x0,my]],[[mx,y0],[mx,my],[x0,my]],[[mx,y0],[x1,y0],[mx,my]],[[x1,y0],[x1,my],[mx,my]],[[x0,my],[mx,my],[x0,y1]],[[mx,my],[mx,y1],[x0,y1]],[[mx,my],[x1,my],[mx,y1]],[[x1,my],[x1,y1],[mx,y1]]);
      }else{tris.push([[x0,y0],[x1,y0],[x0,y1]],[[x1,y0],[x1,y1],[x0,y1]]);}
    }}return tris;
  }
  function drawMesh(){
    ctx.clearRect(0,0,W,H);const cfg=CONFIGS[densityLevel],tris=genMesh(cfg,refineRadius),refDist=(refineRadius/100)*BOX.h*0.9;
    ctx.fillStyle='rgba(4,10,22,0.75)';ctx.fillRect(BOX.x,BOX.y,BOX.w,BOX.h);
    tris.forEach(([a,b,c])=>{
      const cx=(a[0]+b[0]+c[0])/3,cy=(a[1]+b[1]+c[1])/3,inZone=Math.sqrt((cx-TCX)**2+(cy-TCY)**2)<refDist;
      ctx.fillStyle=inZone?'rgba(231,76,60,0.16)':'rgba(47,140,255,0.1)';ctx.strokeStyle=inZone?'rgba(231,76,60,0.4)':'rgba(47,140,255,0.22)';ctx.lineWidth=inZone?0.6:0.5;
      ctx.beginPath();ctx.moveTo(a[0],a[1]);ctx.lineTo(b[0],b[1]);ctx.lineTo(c[0],c[1]);ctx.closePath();ctx.fill();ctx.stroke();
    });
    if(heatAlpha>0){for(let i=5;i>=0;i--){const r=(i/5)*refDist*1.2,a2=heatAlpha*(1-i/5)*0.55;const g=ctx.createRadialGradient(TCX,TCY,0,TCX,TCY,r);g.addColorStop(0,`rgba(231,76,60,${a2})`);g.addColorStop(0.6,`rgba(243,156,18,${a2*0.5})`);g.addColorStop(1,'rgba(251,191,36,0)');ctx.fillStyle=g;ctx.beginPath();ctx.arc(TCX,TCY,r,0,Math.PI*2);ctx.fill();}}
    ctx.setLineDash([5,4]);ctx.strokeStyle='rgba(231,76,60,0.5)';ctx.lineWidth=1.4;ctx.beginPath();ctx.arc(TCX,TCY,refDist,0,Math.PI*2);ctx.stroke();ctx.setLineDash([]);
    ctx.strokeStyle='rgba(47,140,255,0.5)';ctx.lineWidth=1.8;ctx.strokeRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.fillStyle='rgba(60,80,110,0.65)';ctx.beginPath();ctx.arc(TCX,TCY,TR,Math.PI,2*Math.PI);ctx.fill();ctx.strokeStyle='rgba(47,140,255,0.4)';ctx.lineWidth=1.3;ctx.stroke();
    ctx.fillStyle='rgba(150,175,196,0.45)';ctx.font='9px Noto Sans SC';ctx.fillText('æŒ¯å­',TCX-10,TCY+16);
    ctx.setLineDash([4,3]);ctx.strokeStyle='rgba(231,76,60,0.35)';ctx.lineWidth=0.9;ctx.beginPath();ctx.moveTo(BOX.x,BOX.y-5);ctx.lineTo(BOX.x,BOX.y+BOX.h+5);ctx.stroke();ctx.setLineDash([]);
    ctx.fillStyle='rgba(231,76,60,0.65)';ctx.font='700 10px JetBrains Mono';ctx.fillText('å•å…ƒæ•°: '+tris.length,BOX.x+BOX.w-112,BOX.y+16);
    document.getElementById('status4txt').textContent=tris.length+'å•å…ƒ';
    const lns=['ä½','ä¸­','é«˜'];document.getElementById('desc4').innerHTML='<strong>ç½‘æ ¼é¢„ç®—ï¼š'+lns[densityLevel]+'å¯†åº¦ï¼ˆ'+tris.length+'å•å…ƒï¼‰</strong><br>ç»†åŒ–åŠå¾„ <strong>'+refineRadius+'%</strong>ï¼šçº¢è‰²è™šçº¿åœˆå†…å•å…ƒ2Ã—2åŠ å¯†ï¼ˆçº¢è‰²ï¼‰ã€‚'+(heatAlpha>0?' çƒ­åŠ›å›¾å¼ºåº¦ <strong style="color:#e74c3c;">'+Math.round(heatAlpha*100)+'%</strong>ã€‚':'')+'<br>ç‚¹å‡»<strong>è‡ªé€‚åº”ç»†åŒ–</strong>ï¼Œç³»ç»Ÿè‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç»†åŒ–åŠå¾„å¹¶å¼€å¯è¯¯å·®çƒ­åŠ›å›¾ã€‚';
  }
  drawMesh();
})();

// ============================================================
// LEVEL 5
// ============================================================
(function(){
  const canvas=document.getElementById('canvas5'),ctx=canvas.getContext('2d'),W=canvas.width,H=canvas.height;
  const matCanvas=document.getElementById('canvas5mat'),matCtx=matCanvas.getContext('2d'),matW=matCanvas.width,matH=matCanvas.height;
  const flowCanvas=document.getElementById('canvas5flow'),flowCtx=flowCanvas.getContext('2d'),flowW=flowCanvas.width,flowH=flowCanvas.height;
  const BOX={x:30,y:20,w:200,h:170},TCX=BOX.x+BOX.w*0.5,TCY=BOX.y+BOX.h,TR=18;
  let gridCols=6,gridRows=4,couplingRange=1,couplingStrength=70,assemblyProgress=100,showCoupling=true;
  const colSlider=document.getElementById('gridColSlider'),rowSlider=document.getElementById('gridRowSlider');
  const rangeSlider=document.getElementById('couplingRangeSlider'),strengthSlider=document.getElementById('couplingStrengthSlider');
  const progressSlider=document.getElementById('assemblyProgressSlider');
  function updateUI(){
    document.getElementById('gridColVal').textContent=gridCols;document.getElementById('gridRowVal').textContent=gridRows;
    document.getElementById('couplingRangeVal').textContent=couplingRange===1?'1 (ç›¸é‚»)':'2 (å…«é‚»åŸŸ)';
    document.getElementById('couplingStrengthVal').textContent=couplingStrength+'%';document.getElementById('assemblyProgressVal').textContent=assemblyProgress+'%';
    document.getElementById('status5txt').textContent=gridCols+'Ã—'+gridRows+'ç½‘æ ¼';
  }
  colSlider.addEventListener('input',function(){gridCols=+this.value;interact.lv5.colChanged=true;updateUI();drawCoupling();drawMatrix();});
  rowSlider.addEventListener('input',function(){gridRows=+this.value;interact.lv5.rowChanged=true;updateUI();drawCoupling();drawMatrix();});
  rangeSlider.addEventListener('input',function(){couplingRange=+this.value;interact.lv5.rangeChanged=true;updateUI();drawCoupling();drawMatrix();});
  strengthSlider.addEventListener('input',function(){couplingStrength=+this.value;interact.lv5.strengthChanged=true;updateUI();drawMatrix();});
  progressSlider.addEventListener('input',function(){assemblyProgress=+this.value;interact.lv5.progressChanged=true;updateUI();drawMatrix();});
  document.getElementById('toggleCouplingBtn').addEventListener('click',function(){showCoupling=!showCoupling;this.innerHTML=showCoupling?'ğŸ”— éšè—è¿æ¥':'ğŸ”— æ˜¾ç¤ºè¿æ¥';drawCoupling();});
  function drawCoupling(){
    ctx.clearRect(0,0,W,H);ctx.fillStyle='rgba(4,10,22,0.8)';ctx.fillRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.strokeStyle='rgba(47,140,255,0.45)';ctx.lineWidth=1.2;ctx.strokeRect(BOX.x,BOX.y,BOX.w,BOX.h);
    ctx.setLineDash([4,3]);ctx.strokeStyle='rgba(231,76,60,0.4)';ctx.lineWidth=0.9;ctx.beginPath();ctx.moveTo(BOX.x,BOX.y-5);ctx.lineTo(BOX.x,BOX.y+BOX.h+5);ctx.stroke();ctx.setLineDash([]);
    ctx.fillStyle='rgba(60,80,110,0.65)';ctx.beginPath();ctx.arc(TCX,TCY,TR,Math.PI,2*Math.PI);ctx.fill();ctx.strokeStyle='rgba(47,140,255,0.4)';ctx.lineWidth=0.9;ctx.stroke();
    ctx.fillStyle='rgba(150,175,196,0.4)';ctx.font='7px Noto Sans SC';ctx.fillText('æŒ¯å­',TCX-10,TCY+12);
    const cellW=BOX.w/gridCols,cellH=BOX.h/gridRows,nodes=[];
    for(let i=0;i<gridCols;i++){for(let j=0;j<gridRows;j++){
      const cx=BOX.x+i*cellW+cellW/2,cy=BOX.y+j*cellH+cellH/2;if(Math.sqrt((cx-TCX)**2+(cy-TCY)**2)<TR+5)continue;
      ctx.strokeStyle='rgba(47,140,255,0.2)';ctx.lineWidth=0.6;ctx.setLineDash([2,2]);ctx.strokeRect(cx-cellW/2+1,cy-cellH/2+1,cellW-2,cellH-2);ctx.setLineDash([]);nodes.push({x:cx,y:cy});
    }}
    if(showCoupling){
      ctx.strokeStyle='rgba(47,140,255,0.35)';ctx.lineWidth=0.7;ctx.setLineDash([3,3]);
      for(let i=0;i<gridCols;i++){for(let j=0;j<gridRows;j++){
        const x1=BOX.x+i*cellW+cellW/2,y1=BOX.y+j*cellH+cellH/2;if(Math.sqrt((x1-TCX)**2+(y1-TCY)**2)<TR+5)continue;
        for(let di=-couplingRange;di<=couplingRange;di++){for(let dj=-couplingRange;dj<=couplingRange;dj++){
          if(di===0&&dj===0)continue;const ni=i+di,nj=j+dj;
          if(ni>=0&&ni<gridCols&&nj>=0&&nj<gridRows){const x2=BOX.x+ni*cellW+cellW/2,y2=BOX.y+nj*cellH+cellH/2;if(Math.sqrt((x2-TCX)**2+(y2-TCY)**2)<TR+5)continue;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.stroke();}
        }}
      }}ctx.setLineDash([]);
    }
    nodes.forEach(({x,y})=>{ctx.fillStyle='#f97316';ctx.shadowBlur=4;ctx.shadowColor='rgba(249,115,22,0.6)';ctx.beginPath();ctx.arc(x,y,2.2,0,2*Math.PI);ctx.fill();ctx.shadowBlur=0;});
    ctx.fillStyle='rgba(150,175,196,0.35)';ctx.font='7px Noto Sans SC';ctx.fillText('èŠ‚ç‚¹ (æ©™)',BOX.x+4,BOX.y-5);
    if(showCoupling){ctx.fillStyle='rgba(47,140,255,0.4)';ctx.fillText('è€¦åˆè¿çº¿',BOX.x+58,BOX.y-5);}
  }
  function genMatrixPattern(){
    const n=gridCols*gridRows,pat=Array(n).fill(null).map(()=>Array(n).fill(0));
    for(let idx=0;idx<n;idx++){const i=idx%gridCols,j=Math.floor(idx/gridCols);pat[idx][idx]=1;
      for(let di=-couplingRange;di<=couplingRange;di++){for(let dj=-couplingRange;dj<=couplingRange;dj++){
        if(di===0&&dj===0)continue;const ni=i+di,nj=j+dj;
        if(ni>=0&&ni<gridCols&&nj>=0&&nj<gridRows){const nidx=nj*gridCols+ni,dist=Math.abs(di)+Math.abs(dj);let s=dist===1?0.6:dist===2?0.25:0.1;s*=(couplingStrength/100);pat[idx][nidx]=s;}
      }}
    }return pat;
  }
  function drawMatrix(){
    matCtx.clearRect(0,0,matW,matH);matCtx.fillStyle='rgba(4,10,22,0.9)';matCtx.fillRect(0,0,matW,matH);
    const n=gridCols*gridRows,dispN=Math.min(n,12),pad=14,cellSz=(matW-pad*2)/dispN;if(cellSz<1.5)return;
    const pat=genMatrixPattern(),thresh=assemblyProgress/100;
    for(let i=0;i<dispN;i++){for(let j=0;j<dispN;j++){
      const x=pad+j*cellSz,y=pad+i*cellSz,val=pat[i][j];
      if(val>0.01&&Math.random()<thresh){if(i===j)matCtx.fillStyle='rgba(155,89,182,0.8)';else{const a=val*(couplingStrength/100)*0.75;matCtx.fillStyle=`rgba(47,140,255,${a})`;}matCtx.fillRect(x,y,cellSz-0.8,cellSz-0.8);}
      else{matCtx.fillStyle='rgba(47,140,255,0.05)';matCtx.fillRect(x,y,cellSz-0.8,cellSz-0.8);}
      matCtx.strokeStyle='rgba(47,140,255,0.12)';matCtx.lineWidth=0.4;matCtx.strokeRect(x,y,cellSz-0.8,cellSz-0.8);
    }}
    matCtx.fillStyle='rgba(150,175,196,0.45)';matCtx.font='bold 8px JetBrains Mono';matCtx.fillText('[K] '+n+'Ã—'+n,pad,pad-4);matCtx.font='7px Noto Sans SC';matCtx.fillText('éé›¶å¡«å……',pad,matH-5);
  }
  function drawFinalFlow(){
    flowCtx.clearRect(0,0,flowW,flowH);
    const re=+document.getElementById('reSlider').value,mu=+document.getElementById('muSlider').value/10;
    const bcName=document.getElementById('status3txt').textContent;
    let bcMode='still';if(bcName.includes('é€Ÿåº¦å…¥å£'))bcMode='inlet';else if(bcName.includes('æ»‘ç§»'))bcMode='slip';
    const box={x:18,y:18,w:162,h:155},tcx=box.x+box.w*0.5,tcy=box.y+box.h,tr=15;
    flowCtx.fillStyle='rgba(4,10,22,0.85)';flowCtx.fillRect(box.x,box.y,box.w,box.h);
    flowCtx.strokeStyle='rgba(47,140,255,0.45)';flowCtx.lineWidth=1.2;flowCtx.strokeRect(box.x,box.y,box.w,box.h);
    flowCtx.setLineDash([4,3]);flowCtx.strokeStyle='rgba(231,76,60,0.4)';flowCtx.lineWidth=0.8;flowCtx.beginPath();flowCtx.moveTo(box.x,box.y-2);flowCtx.lineTo(box.x,box.y+box.h+2);flowCtx.stroke();flowCtx.setLineDash([]);
    flowCtx.fillStyle='rgba(60,80,110,0.65)';flowCtx.beginPath();flowCtx.arc(tcx,tcy,tr,Math.PI,2*Math.PI);flowCtx.fill();flowCtx.strokeStyle='rgba(47,140,255,0.4)';flowCtx.lineWidth=0.8;flowCtx.stroke();
    const gx=9,gy=9,ddx=box.w/(gx+1),ddy=box.h/(gy+1),turb=Math.max(0,(re-30)/70),arLen=8+turb*4;
    for(let i=1;i<=gx;i++){for(let j=1;j<=gy;j++){
      const px=box.x+i*ddx,py=box.y+j*ddy;if(Math.sqrt((px-tcx)**2+(py-tcy)**2)<tr+2)continue;
      let vx=0,vy=0;const nx=(px-tcx)/(box.w/2),ny=(py-box.y)/box.h;
      if(bcMode==='still'){vx=Math.sin(nx*3+0.5)*0.1;vy=-Math.abs(Math.cos(ny*2+0.4))*0.12;}
      else if(bcMode==='inlet'){const d=Math.sqrt(nx*nx+(ny-1)**2);vx=nx*0.5/(d+0.3)+Math.sin(1.5+ny*3)*turb*0.3;vy=-1.1/(d+0.15)*(1-ny*0.5)+Math.cos(1.2+nx*2)*turb*0.25;}
      else{vx=-Math.sin(ny*Math.PI)*0.7+Math.sin(0.8+nx*2)*turb*0.4;vy=Math.cos(nx*Math.PI*0.6)*0.2+Math.sin(0.6+ny*3)*turb*0.3;}
      const mag=Math.sqrt(vx*vx+vy*vy)||0.01,nvx=vx/mag,nvy=vy/mag,ex=px+nvx*arLen,ey=py+nvy*arLen,spd=Math.min(1,mag*2);
      flowCtx.strokeStyle=`rgb(${Math.round(30+spd*160)},${Math.round(80+spd*100)},${Math.round(220-spd*150)})`;flowCtx.lineWidth=1.1;flowCtx.beginPath();flowCtx.moveTo(px,py);flowCtx.lineTo(ex,ey);flowCtx.stroke();
      const ang=Math.atan2(nvy,nvx),c=`rgb(${Math.round(30+spd*160)},${Math.round(80+spd*100)},${Math.round(220-spd*150)})`;
      flowCtx.fillStyle=c;flowCtx.beginPath();flowCtx.moveTo(ex,ey);flowCtx.lineTo(ex-4*Math.cos(ang-0.4),ey-4*Math.sin(ang-0.4));flowCtx.lineTo(ex-4*Math.cos(ang+0.4),ey-4*Math.sin(ang+0.4));flowCtx.closePath();flowCtx.fill();
    }}
    flowCtx.fillStyle='rgba(47,140,255,0.65)';flowCtx.font='bold 8px JetBrains Mono';flowCtx.fillText('Re='+re,box.x+8,box.y+13);
    flowCtx.fillStyle='rgba(150,175,196,0.5)';flowCtx.font='7px Noto Sans SC';flowCtx.fillText('Î¼='+mu.toFixed(1),box.x+8,box.y+24);
    flowCtx.fillStyle='rgba(47,200,150,0.6)';flowCtx.fillText(bcMode==='inlet'?'é€Ÿåº¦å…¥å£':bcMode==='slip'?'æ»‘ç§»å£é¢':'æ— æ»‘ç§»',box.x+8,box.y+35);
    requestAnimationFrame(drawFinalFlow);
  }
  colSlider.value=gridCols;rowSlider.value=gridRows;rangeSlider.value=couplingRange;strengthSlider.value=couplingStrength;progressSlider.value=assemblyProgress;
  updateUI();drawCoupling();drawMatrix();drawFinalFlow();
})();

// ============================================================
// INFO-BTN HOVER  (ç²¾è®²å¼¹å‡ºæ¡†)
// ============================================================
(function(){
  document.querySelectorAll('.info-btn').forEach(btn=>{
    const popup=document.getElementById(btn.dataset.popup);
    if(!popup)return;
    let hideTimer=null;
    function show(){
      clearTimeout(hideTimer);
      document.querySelectorAll('.info-popup').forEach(p=>{if(p!==popup)p.style.display='none';});
      popup.style.display='block';btn.classList.add('active');
    }
    function hide(){hideTimer=setTimeout(()=>{popup.style.display='none';btn.classList.remove('active');},150);}
    btn.addEventListener('mouseenter',show);
    btn.addEventListener('mouseleave',hide);
    btn.addEventListener('click',function(){popup.style.display==='block'?hide():show();});
  });
  document.addEventListener('click',function(e){
    if(!e.target.closest('.info-btn')&&!e.target.closest('.info-popup')){
      document.querySelectorAll('.info-popup').forEach(p=>p.style.display='none');
      document.querySelectorAll('.info-btn').forEach(b=>b.classList.remove('active'));
    }
  });
})();

// ============================================================
// EVAL MODAL  (åŒæ¥æºé›·è¾¾å›¾ï¼šé¢˜ç›®50% + æ“ä½œæ¢ç´¢50%)
// ============================================================
(function(){
  const modal=document.getElementById('evalModal'),closeBtn=document.getElementById('closeModal'),evalBtn=document.getElementById('evalBtn');
  const quizContainer=document.getElementById('quizContainer'),submitBtn=document.getElementById('submitQuizBtn');
  const radarCanvas=document.getElementById('radarCanvas'),ctxR=radarCanvas.getContext('2d');
  const engineerEl=document.getElementById('engineerLevel'),adviceEl=document.getElementById('adviceText');
  const totalEl=document.getElementById('totalScoreDisplay'),fillEl=document.getElementById('scoreFill');
  const interactEl=document.getElementById('interactScores');

  const questions=[
    {title:'1. æœ‰é™å…ƒç¬¬ä¸€æ­¥"å‡ ä½•æŠ½è±¡"ä¸­ï¼Œå°†3DåŠ æ¹¿å™¨ç®€åŒ–ä¸º2Dè½´å¯¹ç§°æ¨¡å‹çš„ä¸»è¦ç›®çš„æ˜¯ï¼Ÿ',
     options:[{text:'A. å‡å°‘è®¡ç®—é‡ï¼Œæé«˜æ±‚è§£æ•ˆç‡',score:20},{text:'B. è®©æ¨¡å‹çœ‹èµ·æ¥æ›´ç®€æ´',score:5},{text:'C. æœ‰é™å…ƒè½¯ä»¶å¿…é¡»ä½¿ç”¨2Dæ¨¡å‹',score:0},{text:'D. ä¸ºäº†ä¿ç•™æ‰€æœ‰å¾®å°ç‰¹å¾',score:0}]},
    {title:'2. åœ¨Navier-Stokesæ–¹ç¨‹ä¸­ï¼Œå“ªä¸€é¡¹ä»£è¡¨"ç²˜æ€§åŠ›"ï¼Ÿ',
     options:[{text:'A. Ï(âˆ‚u/âˆ‚t) â€”â€” éå®šå¸¸é¡¹',score:0},{text:'B. uÂ·âˆ‡u â€”â€” æƒ¯æ€§é¡¹',score:0},{text:'C. Î¼âˆ‡Â²u â€”â€” ç²˜æ€§é¡¹',score:20},{text:'D. -âˆ‡p â€”â€” å‹åŠ›é¡¹',score:0}]},
    {title:'3. åœ¨åŠ æ¹¿å™¨æ¨¡æ‹Ÿä¸­ï¼Œè¶…å£°æŒ¯å­é€šå¸¸ä½¿ç”¨å“ªç§è¾¹ç•Œæ¡ä»¶æ¥æ¨¡æ‹Ÿå–·æµæ•ˆæœï¼Ÿ',
     options:[{text:'A. æ— æ»‘ç§»å£é¢',score:0},{text:'B. é€Ÿåº¦å…¥å£',score:20},{text:'C. æ»‘ç§»å£é¢',score:5},{text:'D. å¯¹ç§°è¾¹ç•Œ',score:0}]},
    {title:'4. è‡ªé€‚åº”ç½‘æ ¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ä»€ä¹ˆï¼Ÿ',
     options:[{text:'A. æ‰€æœ‰åŒºåŸŸç½‘æ ¼å¯†åº¦å®Œå…¨ç›¸åŒ',score:0},{text:'B. åªåœ¨è¯¯å·®ä¼°è®¡é«˜çš„åŒºåŸŸåŠ å¯†ç½‘æ ¼',score:20},{text:'C. ç½‘æ ¼è¶Šç»†è¶Šå¥½ï¼Œå…¨åŸŸåŠ å¯†',score:0},{text:'D. éšæœºåŠ å¯†æŸäº›åŒºåŸŸ',score:0}]},
    {title:'5. å…¨å±€åˆšåº¦çŸ©é˜µ[K]ä¸­çš„éé›¶å…ƒç´ ä»£è¡¨ä»€ä¹ˆç‰©ç†å«ä¹‰ï¼Ÿ',
     options:[{text:'A. èŠ‚ç‚¹ä¹‹é—´çš„è€¦åˆå…³ç³»',score:20},{text:'B. å•å…ƒçš„ææ–™å¯†åº¦',score:0},{text:'C. è¾¹ç•Œæ¡ä»¶çš„æ•°å€¼',score:0},{text:'D. å¤–è½½è·å‘é‡',score:0}]},
  ];

  function renderQuizzes(){
    quizContainer.innerHTML='';
    questions.forEach((q,idx)=>{
      const qDiv=document.createElement('div');qDiv.className='quiz-item';qDiv.id='qi'+idx;
      qDiv.innerHTML='<div class="quiz-question">'+q.title+'</div>';
      q.options.forEach((opt,oIdx)=>{
        const id='q'+idx+'_o'+oIdx,d=document.createElement('div');
        d.className='quiz-option';d.dataset.score=opt.score;d.dataset.qi=idx;
        d.innerHTML='<input type="radio" name="q'+idx+'" id="'+id+'" value="'+opt.score+'"><label for="'+id+'">'+opt.text+'</label>';
        d.addEventListener('click',function(){document.querySelectorAll('[data-qi="'+idx+'"]').forEach(el=>el.classList.remove('selected'));this.classList.add('selected');this.querySelector('input').checked=true;document.getElementById('qi'+idx).classList.add('answered');});
        qDiv.appendChild(d);
      });
      quizContainer.appendChild(qDiv);
    });
  }

  function computeQuizScores(){return questions.map((_,i)=>{const rs=document.getElementsByName('q'+i);for(const r of rs)if(r.checked)return +r.value;return 0;});}

  function drawRadar(qS,iS){
    const w=240,h=240,cx=w/2,cy=h/2,R=Math.min(w,h)*0.3;
    const angles=[0,72,144,216,288].map(d=>d*Math.PI/180),dims=['å‡ ä½•','æ–¹ç¨‹','è¾¹ç•Œ','ç½‘æ ¼','è€¦åˆ'];
    ctxR.clearRect(0,0,w,h);ctxR.save();ctxR.translate(cx,cy);
    // rings
    for(let lv=1;lv<=5;lv++){ctxR.strokeStyle='rgba(47,140,255,0.12)';ctxR.lineWidth=0.8;ctxR.beginPath();const r=R*(lv/5);for(let i=0;i<=5;i++){const a=angles[i%5],x=r*Math.sin(a),y=-r*Math.cos(a);i===0?ctxR.moveTo(x,y):ctxR.lineTo(x,y);}ctxR.closePath();ctxR.stroke();}
    // axes
    angles.forEach(a=>{ctxR.strokeStyle='rgba(47,140,255,0.2)';ctxR.lineWidth=0.8;ctxR.beginPath();ctxR.moveTo(0,0);ctxR.lineTo(R*Math.sin(a),-R*Math.cos(a));ctxR.stroke();});
    // interact polygon (green dashed)
    ctxR.beginPath();for(let i=0;i<5;i++){const r=R*(iS[i]/20),x=r*Math.sin(angles[i]),y=-r*Math.cos(angles[i]);i===0?ctxR.moveTo(x,y):ctxR.lineTo(x,y);}ctxR.closePath();
    ctxR.fillStyle='rgba(46,204,113,0.12)';ctxR.fill();ctxR.strokeStyle='rgba(46,204,113,0.7)';ctxR.lineWidth=1.5;ctxR.setLineDash([4,3]);ctxR.stroke();ctxR.setLineDash([]);
    // quiz polygon (blue solid)
    ctxR.beginPath();for(let i=0;i<5;i++){const r=R*(qS[i]/20),x=r*Math.sin(angles[i]),y=-r*Math.cos(angles[i]);i===0?ctxR.moveTo(x,y):ctxR.lineTo(x,y);}ctxR.closePath();
    ctxR.fillStyle='rgba(47,140,255,0.2)';ctxR.fill();ctxR.strokeStyle='#2f8cff';ctxR.lineWidth=2;ctxR.stroke();
    // dots quiz
    for(let i=0;i<5;i++){const r=R*(qS[i]/20),x=r*Math.sin(angles[i]),y=-r*Math.cos(angles[i]);ctxR.fillStyle='#2f8cff';ctxR.shadowBlur=6;ctxR.shadowColor='#2f8cff';ctxR.beginPath();ctxR.arc(x,y,3,0,Math.PI*2);ctxR.fill();ctxR.shadowBlur=0;}
    // dots interact
    for(let i=0;i<5;i++){const r=R*(iS[i]/20),x=r*Math.sin(angles[i]),y=-r*Math.cos(angles[i]);ctxR.fillStyle='#2ecc71';ctxR.shadowBlur=5;ctxR.shadowColor='#2ecc71';ctxR.beginPath();ctxR.arc(x,y,2.5,0,Math.PI*2);ctxR.fill();ctxR.shadowBlur=0;}
    // labels
    ctxR.font='bold 11px "JetBrains Mono",monospace';ctxR.fillStyle='rgba(150,175,196,1)';ctxR.shadowColor='#2f8cff';ctxR.shadowBlur=0;
    angles.forEach((a,i)=>{const x=(R+22)*Math.sin(a),y=-(R+22)*Math.cos(a);ctxR.fillText(dims[i],x-12,y+4);});
    ctxR.shadowBlur=0;ctxR.restore();
  }

  function updateLevel(qS,iS){
    const combined=qS.map((q,i)=>q*0.5+iS[i]*0.5);
    const total=Math.round(combined.reduce((a,b)=>a+b,0)),avg=combined.reduce((a,b)=>a+b,0)/5;
    let level=avg<8?'å®ä¹ ç”Ÿ Â· P0':avg<12?'åŠ©ç†å·¥ç¨‹å¸ˆ Â· P1':avg<16?'åˆçº§å·¥ç¨‹å¸ˆ Â· P2':avg<18?'ä¸­çº§å·¥ç¨‹å¸ˆ Â· P3':avg<20?'é«˜çº§å·¥ç¨‹å¸ˆ Â· P4':'ä¸“å®¶å·¥ç¨‹å¸ˆ Â· P5';
    engineerEl.textContent=level;totalEl.textContent=total+' / 100';fillEl.style.width=total+'%';
    const minC=Math.min(...combined),minI=combined.indexOf(minC);
    const dims=['å‡ ä½•æŠ½è±¡','æ–¹ç¨‹ç‰©æ€§','è¾¹ç•Œæ§åˆ¶','ç½‘æ ¼è‡ªé€‚åº”','è€¦åˆç»„è£…'];
    let advice='';
    if(minC>=18){advice='ğŸ‰ æ‚¨å·²å…¨é¢æŒæ¡æœ‰é™å…ƒæ ¸å¿ƒæ€ç»´ï¼å¯å°è¯•çœŸå®CAEè½¯ä»¶ï¼ˆCOMSOL/ANSYSï¼‰å®Œæˆå¤šç‰©ç†åœºè€¦åˆåˆ†æã€‚';}
    else{
      const qWeak=qS[minI]<iS[minI];
      advice='ğŸ” æ‚¨çš„<strong>'+dims[minI]+'</strong>ç»´åº¦ç›¸å¯¹è–„å¼±ï¼ˆç»¼åˆ '+Math.round(minC)+'/20ï¼‰ã€‚';
      if(qWeak)advice+='<em style="color:rgba(100,180,255,0.8);">ç†è®ºç†è§£åå¼±ï¼Œå»ºè®®æ‚¬æµ®ğŸ’¡ç²¾è®²æŒ‰é’®æ·±å…¥å­¦ä¹ ã€‚</em>';
      else advice+='<em style="color:rgba(46,204,113,0.8);">ç†è®ºä½œç­”è‰¯å¥½ï¼Œä½†æ“ä½œæ¢ç´¢ä¸è¶³ï¼Œå»ºè®®å¤šè°ƒèŠ‚è¯¥å…³å¡å‚æ•°ã€‚</em>';
      const tips=['â†© è¿”å›ç¬¬ä¸€å…³ï¼šè°ƒèŠ‚æ—‹è½¬/é€è§†/æ°´ä½ï¼Œå¹¶ç‚¹å‡»ã€ä¸€é”®ç®€åŒ–ã€‘ä½“éªŒé™ç»´ã€‚','â†© è¿”å›ç¬¬äºŒå…³ï¼šå°†Reä»0æ‹–åˆ°100ï¼Œå¯¹æ¯”å±‚æµä¸æ¹æµå½¢æ€ã€‚','â†© è¿”å›ç¬¬ä¸‰å…³ï¼šåˆ‡æ¢å…¨éƒ¨3ç§è¾¹ç•Œæ¡ä»¶ï¼Œæ„Ÿå—æµåœºé‡æ„æ•ˆæœã€‚','â†© è¿”å›ç¬¬å››å…³ï¼šåˆ‡æ¢ç½‘æ ¼æ¡£ä½å¹¶ç‚¹å‡»è‡ªé€‚åº”ç»†åŒ–ï¼Œä½“ä¼šæ™ºèƒ½åˆ†é…ç®—åŠ›ã€‚','â†© è¿”å›ç¬¬äº”å…³ï¼šè°ƒèŠ‚è€¦åˆèŒƒå›´/å¼ºåº¦/ç»„è£…è¿›åº¦ï¼Œè§‚å¯ŸçŸ©é˜µå¡«å……ä¸æµåœºå…³è”ã€‚'];
      advice+='<br>'+tips[minI];
    }
    adviceEl.innerHTML=advice;
    // æ˜¾ç¤ºæ“ä½œå¾—åˆ†æ˜ç»†
    const dimNames=['å‡ ä½•','æ–¹ç¨‹','è¾¹ç•Œ','ç½‘æ ¼','è€¦åˆ'];
    interactEl.style.display='grid';
    interactEl.innerHTML=iS.map((s,i)=>`<div class="interact-score-item">æ“ä½œÂ·${dimNames[i]}: <strong>${s}/20</strong><div class="score-bar" style="margin-top:3px;"><div class="score-fill" style="width:${s*5}%;background:linear-gradient(90deg,#2ecc71,#2f8cff);"></div></div></div>`).join('');
    // æ ‡æ³¨ç­”é¢˜æ­£è¯¯
    questions.forEach((q,idx)=>{
      const maxS=Math.max(...q.options.map(o=>o.score));
      document.querySelectorAll('[data-qi="'+idx+'"]').forEach((el,oIdx)=>{
        el.classList.remove('correct','wrong');const isCor=q.options[oIdx].score===maxS,isSel=el.querySelector('input').checked;
        if(isCor)el.classList.add('correct');else if(isSel&&!isCor)el.classList.add('wrong');
      });
    });
  }

  submitBtn.addEventListener('click',function(){const qS=computeQuizScores(),iS=interact.score();drawRadar(qS,iS);updateLevel(qS,iS);});
  evalBtn.addEventListener('click',()=>modal.classList.add('active'));
  closeBtn.addEventListener('click',()=>modal.classList.remove('active'));
  modal.addEventListener('click',e=>{if(e.target===modal)modal.classList.remove('active');});
  renderQuizzes();drawRadar([0,0,0,0,0],[0,0,0,0,0]);engineerEl.textContent='å¾…è¯„æµ‹';
})();
</script>
</body>
</html>
