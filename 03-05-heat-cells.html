<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电池包多层热阻模拟训练器 - 最终版</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a2a3a 0%, #2c3e50 100%);
            color: #f0f0f0;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: rgba(30, 40, 50, 0.85);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            color: #4fc3f7;
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(79, 195, 247, 0.3);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            font-size: 2.2rem;
        }
        
        .subtitle {
            text-align: center;
            color: #b0bec5;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .controls-panel {
            flex: 1;
            min-width: 320px;
            background-color: rgba(40, 50, 65, 0.8);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .visualization {
            flex: 2.2;
            min-width: 500px;
            background-color: rgba(35, 45, 60, 0.8);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
        }
        
        .viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .viz-header h3 {
            margin: 0;
            color: #4fc3f7;
        }
        
        .viz-content {
            display: flex;
            flex: 1;
            gap: 20px;
        }
        
        .canvas-container {
            position: relative;
            flex: 3;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            background: linear-gradient(to bottom, rgba(20, 30, 40, 0.9), rgba(30, 40, 55, 0.9));
            height: 400px;
        }
        
        #thermalCanvas {
            width: 100%;
            height: 100%;
        }
        
        .results-sidebar {
            flex: 1;
            min-width: 220px;
            background-color: rgba(30, 40, 55, 0.9);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .results-title {
            font-weight: 700;
            color: #4fc3f7;
            margin-bottom: 20px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(79, 195, 247, 0.3);
        }
        
        .results-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .result-item {
            background: linear-gradient(135deg, rgba(50, 70, 90, 0.8), rgba(40, 55, 75, 0.8));
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
            border-left: 4px solid #4fc3f7;
        }
        
        .result-label {
            font-size: 0.9rem;
            color: #b0bec5;
            margin-bottom: 1px;
        }
        
        .result-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #ffffff;
        }
        
        .result-unit {
            font-size: 0.9rem;
            color: #b0bec5;
            margin-left: 3px;
        }
        
        .layer-control {
            margin-bottom: -10px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .layer-control:last-child {
            border-bottom: none;
        }
        
        .layer-title {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .layer-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: white;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
        }
        
        .layer-name {
            font-weight: 600;
            font-size: 1.2rem;
            color: #e0e0e0;
        }
        
        .layer-desc {
            font-size: 0.9rem;
            color: #b0bec5;
            margin-left: 0px;
            margin-bottom: 12px;
        }
        
        .control-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            align-items: center;
        }
        
        .control-label {
            font-weight: 500;
            color: #e0e0e0;
            min-width: 140px;
        }
        
        .control-value {
            font-weight: 600;
            color: #4fc3f7;
            min-width: 60px;
            text-align: right;
        }
        
        .slider-container {
            flex: 1;
            margin: 0 15px;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(100, 120, 140, 0.5);
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #4fc3f7;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            background: #29b6f6;
            transform: scale(1.1);
        }
        
        select {
            padding: 8px 15px;
            border-radius: 6px;
            border: 1px solid rgba(100, 120, 140, 0.5);
            background-color: rgba(30, 40, 55, 0.9);
            font-size: 1rem;
            color: #e0e0e0;
            width: 100%;
            margin-top: 5px;
        }
        
        /* 图例容器移到展示区中间下方 */
        .legend-container {
            display: flex;
            justify-content: left;
            margin-top: -380px;
            margin-bottom: 10px;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            padding: 12px 20px;
            background-color: rgba(40, 50, 65, 0.8);
            border-radius: 8px;
            max-width: 480px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            margin-right: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .simulation-instructions {
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 193, 7, 0.05));
            border-radius: 10px;
            padding: 15px 20px;
            margin-top: 10px;
            border-left: 5px solid #ff9800;
width: 67%;
margin-left: fix;
margin-right: auto;
        }
        
        .simulation-instructions h3 {
            color: #ffb74d;
            margin-top: 0;
            display: flex;
            align-items: center;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .simulation-instructions ul {
            padding-left: 20px;
            margin: 0;
        }
        
        .simulation-instructions li {
            margin-bottom: 6px;
            color: #ffcc80;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .temperature-scale {
            position: absolute;
            right: 20px;
            top: 20px;
            width: 20px;
            height: 300px;
            background: linear-gradient(to bottom, #e74c3c 0%, #2980b9 100%);
            border-radius: 4px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .scale-labels {
            position: absolute;
            right: 45px;
            top: 20px;
            height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            color: #e0e0e0;
            font-size: 0.9rem;
        }
        
        .scale-title {
            position: absolute;
            right: 20px;
            top: 330px;
            font-size: 0.9rem;
            color: #b0bec5;
            text-align: center;
            width: 35px;
        }
        
        .challenge-section {
            background-color: rgba(40, 50, 65, 0.8);
            border-radius: 12px;
            padding: 25px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .challenge-title {
            font-size: 1.5rem;
            color: #4fc3f7;
            margin: 0;
        }
        
        .mode-buttons {
            display: flex;
            gap: 15px;
        }
        
        .mode-btn {
            padding: 10px 20px;
            border-radius: 6px;
            background-color: rgba(30, 40, 55, 0.9);
            color: #b0bec5;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .mode-btn.active {
            background-color: #4fc3f7;
            color: #1a2a3a;
            box-shadow: 0 0 15px rgba(79, 195, 247, 0.5);
        }
        
        .mode-btn.completed {
            background-color: #2ecc71;
            color: #1a2a3a;
        }
        
        .exploration-panel {
            background-color: rgba(30, 40, 55, 0.9);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            display: block;
        }
        
        .assessment-panel {
            background-color: rgba(30, 40, 55, 0.9);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            display: none;
        }
        
        .results-panel {
            background-color: rgba(30, 40, 55, 0.9);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            display: none;
        }
        
        .assessment-page {
            display: none;
        }
        
        .assessment-page.active {
            display: block;
        }
        
        .assessment-question {
            font-size: 1.2rem;
            color: #e0e0e0;
            margin-bottom: 25px;
            line-height: 1.6;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .assessment-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-group label {
            margin-bottom: 8px;
            color: #b0bec5;
            font-weight: 500;
        }
        
        .input-group input {
            padding: 12px 15px;
            border-radius: 6px;
            border: 1px solid rgba(100, 120, 140, 0.5);
            background-color: rgba(40, 50, 65, 0.9);
            color: #e0e0e0;
            font-size: 1.1rem;
        }
        
        .solution-steps {
            background-color: rgba(40, 50, 65, 0.9);
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
            border-left: 4px solid #2ecc71;
            display: none;
        }
        
        .solution-steps.show {
            display: block;
        }
        
        .solution-title {
            color: #2ecc71;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .solution-steps ol {
            padding-left: 20px;
            color: #e0e0e0;
        }
        
        .solution-steps li {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .answer-feedback {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: 600;
            display: none;
        }
        
        .answer-feedback.correct {
            background-color: rgba(46, 204, 113, 0.2);
            border: 2px solid #2ecc71;
            color: #2ecc71;
            display: block;
        }
        
        .answer-feedback.incorrect {
            background-color: rgba(231, 76, 60, 0.2);
            border: 2px solid #e74c3c;
            color: #e74c3c;
            display: block;
        }
        
        .challenge-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .btn-primary {
            background-color: #4fc3f7;
            color: #1a2a3a;
        }
        
        .btn-primary:hover {
            background-color: #29b6f6;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(41, 182, 246, 0.4);
        }
        
        .btn-secondary {
            background-color: rgba(100, 120, 140, 0.5);
            color: #e0e0e0;
        }
        
        .btn-secondary:hover {
            background-color: rgba(120, 140, 160, 0.6);
            transform: translateY(-2px);
        }
        
        .btn-reset {
            background-color: #ff9800;
            color: #1a2a3a;
        }
        
        .btn-reset:hover {
            background-color: #f57c00;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 152, 0, 0.4);
        }
        
        .rating-system {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .rating-item {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            background-color: rgba(30, 40, 55, 0.9);
            width: 180px;
            transition: all 0.3s ease;
            opacity: 0.5;
        }
        
        .rating-item.active {
            opacity: 1;
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.5);
            border: 2px solid #4fc3f7;
        }
        
        .rating-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #4fc3f7;
        }
        
        .rating-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        
        .rating-desc {
            font-size: 0.9rem;
            color: #b0bec5;
        }
        
        .progress-container {
            margin-top: 25px;
            padding: 15px;
            background-color: rgba(30, 40, 55, 0.9);
            border-radius: 8px;
        }
        
        .progress-title {
            font-size: 1.1rem;
            color: #4fc3f7;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .progress-bar {
            height: 20px;
            background-color: rgba(100, 120, 140, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            text-align: center;
            color: #b0bec5;
            font-size: 0.9rem;
        }
        
        .results-content {
            padding: 20px;
            background-color: rgba(40, 50, 65, 0.9);
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .final-rating {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.1), rgba(52, 152, 219, 0.1));
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #4fc3f7;
        }
        
        .final-rating h3 {
            color: #4fc3f7;
            font-size: 2rem;
            margin-bottom: 15px;
        }
        
        .final-rating p {
            font-size: 1.2rem;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        
        .improvement-suggestions {
            background-color: rgba(255, 152, 0, 0.1);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #ff9800;
        }
        
        .improvement-suggestions h4 {
            color: #ffb74d;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .improvement-suggestions ul {
            padding-left: 20px;
            color: #ffcc80;
        }
        
        .improvement-suggestions li {
            margin-bottom: 10px;
        }
        
        .detailed-results {
            margin-top: 30px;
        }
        
        .question-result {
            background-color: rgba(50, 70, 90, 0.8);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .question-result.correct {
            border-left-color: #2ecc71;
        }
        
        .question-result.incorrect {
            border-left-color: #e74c3c;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .question-title {
            font-weight: 600;
            color: #e0e0e0;
            font-size: 1.1rem;
        }
        
        .question-status {
            font-weight: 600;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .status-correct {
            background-color: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
        }
        
        .status-incorrect {
            background-color: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }
        
        @media (max-width: 1200px) {
            .viz-content {
                flex-direction: column;
            }
            
            .results-sidebar {
                min-width: 100%;
            }
        }
        
        @media (max-width: 900px) {
            .main-content {
                flex-direction: column;
            }
            
            .controls-panel, .visualization {
                min-width: 100%;
            }
        }
        
        .importance {
            display: inline-block;
            margin-left: 10px;
            font-size: 0.9rem;
        }
        
        .star-rating {
            color: #f1c40f;
            letter-spacing: 2px;
            text-shadow: 0 0 5px rgba(241, 196, 15, 0.5);
        }
        
        .exploration-instructions {
            background-color: rgba(52, 152, 219, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            color: #3498db;
            font-weight: 500;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <h1><i class="fas fa-battery-full"></i> 电池包多层热阻模拟训练器</h1>
        <div class="subtitle">通过调整各层参数，观察热阻与温度分布的变化。从电极片堆叠体到冷却液，理解电池热管理的关键因素。</div>
        
        <div class="main-content">
            <div class="controls-panel">
                <div class="layer-control">
                    <div class="layer-title">
                        <div class="layer-icon" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            1
                        </div>
                        <div class="layer-name">电极片堆叠体</div>
                        <div class="importance">
                            <span class="star-rating">⭐⭐⭐⭐⭐</span>
                        </div>
                    </div>
                    <div class="layer-desc">电池内部多层结构，导热性差，是热阻主要贡献者</div>
                    
                    <div class="control-row">
                        <div class="control-label">厚度 (mm):</div>
                        <div class="slider-container">
                            <input type="range" id="electrodeThickness" min="1" max="20" step="0.1" value="10">
                        </div>
                        <div class="control-value" id="electrodeThicknessValue">10.0</div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">导热系数 (W/m·K):</div>
                        <div class="slider-container">
                            <input type="range" id="electrodeConductivity" min="0.1" max="5" step="0.1" value="1.5">
                        </div>
                        <div class="control-value" id="electrodeConductivityValue">1.5</div>
                    </div>
                </div>
                
                <div class="layer-control">
                    <div class="layer-title">
                        <div class="layer-icon" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                            2
                        </div>
                        <div class="layer-name">界面层</div>
                        <div class="importance">
                            <span class="star-rating">⭐⭐⭐⭐</span>
                        </div>
                    </div>
                    <div class="layer-desc">电芯与外壳间的导热界面材料，常被忽视但对散热至关重要</div>
                    
                    <div class="control-row">
                        <div class="control-label">厚度 (mm):</div>
                        <div class="slider-container">
                            <input type="range" id="interfaceThickness" min="0.1" max="3" step="0.05" value="0.5">
                        </div>
                        <div class="control-value" id="interfaceThicknessValue">0.50</div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">导热系数 (W/m·K):</div>
                        <div class="slider-container">
                            <input type="range" id="interfaceConductivity" min="0.1" max="3" step="0.05" value="0.8">
                        </div>
                        <div class="control-value" id="interfaceConductivityValue">0.8</div>
                    </div>
                </div>
                
                <div class="layer-control">
                    <div class="layer-title">
                        <div class="layer-icon" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                            3
                        </div>
                        <div class="layer-name">金属外壳</div>
                        <div class="importance">
                            <span class="star-rating">⭐</span>
                        </div>
                    </div>
                    <div class="layer-desc">铝或钢制外壳，导热性好，热阻贡献最小</div>
                    
                    <div class="control-row">
                        <div class="control-label">厚度 (mm):</div>
                        <div class="slider-container">
                            <input type="range" id="shellThickness" min="0.5" max="5" step="0.1" value="2.0">
                        </div>
                        <div class="control-value" id="shellThicknessValue">2.0</div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">材料:</div>
                        <div style="flex: 1; margin-left: 15px;">
                            <select id="shellMaterial">
                                <option value="237">铝 (237 W/m·K)</option>
                                <option value="50">钢 (50 W/m·K)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="layer-control">
                    <div class="layer-title">
                        <div class="layer-icon" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
                            4
                        </div>
                        <div class="layer-name">冷却液对流</div>
                        <div class="importance">
                            <span class="star-rating">⭐⭐</span>
                        </div>
                    </div>
                    <div class="layer-desc">通过液冷系统带走热量，对流换热系数影响散热效率</div>
                    
                    <div class="control-row">
                        <div class="control-label">冷却液类型:</div>
                        <div style="flex: 1; margin-left: 15px;">
                            <select id="coolantType">
                                <option value="1000">水 (1000 W/m²·K)</option>
                                <option value="800">乙二醇水溶液 (800 W/m²·K)</option>
                                <option value="200">油 (200 W/m²·K)</option>
                                <option value="1500">增强型冷却剂 (1500 W/m²·K)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">对流系数 (W/m²·K):</div>
                        <div class="slider-container">
                            <input type="range" id="convectionCoefficient" min="50" max="2000" step="50" value="1000">
                        </div>
                        <div class="control-value" id="convectionCoefficientValue">1000</div>
                    </div>
                </div>
            </div>
            
            <div class="visualization">
                <div class="viz-header">
                    <h3><i class="fas fa-chart-area"></i> 多层热阻与温度分布可视化</h3>
                    <button class="btn btn-reset" id="resetBtn">
                        <i class="fas fa-redo-alt"></i> 重置参数
                    </button>
                </div>
                
                <div class="viz-content">
                    <div class="canvas-container">
                        <canvas id="thermalCanvas"></canvas>
                        <div class="temperature-scale"></div>
                        <div class="scale-labels">
                            <span>100°C</span>
                            <span>81°C</span>
                            <span>63°C</span>
                            <span>44°C</span>
                            <span>25°C</span>
                        </div>
                        <div class="scale-title">温度标尺</div>
                    </div>
                    
                    <div class="results-sidebar">
                        <div class="results-title">
                            <i class="fas fa-calculator"></i> 热阻与温度计算结果
                        </div>
                        <div class="results-grid">
                            <div class="result-item">
                                <div class="result-label">总热阻</div>
                                <div class="result-value" id="totalResistance">0.000</div>
                                <span class="result-unit">m²·K/W</span>
                            </div>
                            <div class="result-item">
                                <div class="result-label">热流量</div>
                                <div class="result-value" id="heatFlux">0.000</div>
                                <span class="result-unit">W/m²</span>
                            </div>
                            <div class="result-item">
                                <div class="result-label">电极温度</div>
                                <div class="result-value" id="maxTemp">100.0</div> 
                                <span class="result-unit">°C</span>

                            </div>
                            <div class="result-item">
                                <div class="result-label">冷却液温度</div>

                                <div class="result-value" id="minTemp">25.0</div>
                                <span class="result-unit">°C</span>
                            </div>
                            <div class="result-item">
                                <div class="result-label">电极热阻占比</div>
                                <div class="result-value" id="electrodeResistancePercent">0.0</div>
                                <span class="result-unit">%</span>
                            </div>
                            <div class="result-item">
                                <div class="result-label">界面热阻占比</div>
                                <div class="result-value" id="interfaceResistancePercent">0.0</div>
                                <span class="result-unit">%</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 图例移到展示区中间下方 -->
                <div class="legend-container">
                    <div class="legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #e74c3c;"></div>
                            <span>电极片堆叠体</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #3498db;"></div>
                            <span>界面层</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #2ecc71;"></div>
                            <span>金属外壳</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #9b59b6;"></div>
                            <span>冷却液对流</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background: linear-gradient(to right, #e74c3c, #2980b9);"></div>
                            <span>温度梯度</span>
                        </div>
                    </div>
                </div>
                
                <!-- 模拟说明向上提高 -->
                <div class="simulation-instructions">
                    <h3><i class="fas fa-lightbulb"></i>  模拟说明</h3>
                    <ul>
                        <li><strong>多层区显示的是实际温度，不是温差</strong>：从电极热端100°C到冷却液冷端25°C</li>
                        <li>本模拟基于一维稳态热传导方程，假设各层紧密接触且无接触热阻</li>
                        <li>热流量计算公式：q = ΔT / R<sub>total</sub>，其中ΔT = 75°C (电极100°C - 冷却液25°C)</li>
                        <li>每层热阻：R = 厚度/(导热系数) (固体层) 或 R = 1/对流系数 (对流层)</li>
                        <li>拖动滑块调整各层参数，观察温度分布与热阻变化</li>
                        <li>⭐数量表示该层对总热阻的重要性（根据你的评估）</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="challenge-section">
            <div class="challenge-header">
                <h3 class="challenge-title"><i class="fas fa-gamepad"></i> 热阻计算训练</h3>
                <div class="mode-buttons">
                    <div class="mode-btn active" data-mode="exploration">
                        <i class="fas fa-sliders-h"></i> 探索模式
                    </div>
                    <div class="mode-btn" data-mode="assessment">
                        <i class="fas fa-clipboard-check"></i> 评测模式
                    </div>
                    <div class="mode-btn" data-mode="results" style="display: none;">
                        <i class="fas fa-medal"></i> 评测结果
                    </div>
                </div>
            </div>
            
            <!-- 探索模式 -->
            <div class="exploration-panel" id="explorationPanel">
                <div class="exploration-instructions">
                    <i class="fas fa-info-circle"></i> 请先调整各层参数，观察热阻与温度分布的变化。完成后点击下方按钮进入评测。
                </div>
                
                <div class="progress-container">
                    <div class="progress-title">探索进度</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="explorationProgress"></div>
                    </div>
                    <div class="progress-text" id="explorationProgressText">已调节0/7个参数</div>
                </div>
                
                <div class="challenge-buttons">
                    <button class="btn btn-primary" id="startAssessmentBtn">
                        <i class="fas fa-arrow-right"></i> 进入评测
                    </button>
                </div>
            </div>
            
            <!-- 评测模式 -->
            <div class="assessment-panel" id="assessmentPanel">
                <div class="progress-container">
                    <div class="progress-title">评测进度</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="assessmentProgress"></div>
                    </div>
                    <div class="progress-text" id="assessmentProgressText">第1题/共3题</div>
                </div>
                
                <!-- 第1题 -->
                <div class="assessment-page active" id="question1">
                    <div class="assessment-question">
                        <h4>第1题：单层热阻计算</h4>
                        <p>计算单一材料层的热阻。给定材料厚度为5mm，导热系数为2.5 W/m·K，请计算其热阻值。</p>
                        <p><strong>问题：</strong>计算厚度为5mm，导热系数为2.5 W/m·K的材料层的热阻是多少？</p>
                    </div>
                    
                    <div class="assessment-inputs">
                        <div class="input-group">
                            <label for="answerInput1">热阻 (m²·K/W):</label>
                            <input type="number" step="0.0001" id="answerInput1" placeholder="输入热阻值">
                        </div>
                    </div>
                    
                    <div class="solution-steps" id="solution1">
                        <div class="solution-title">
                            <i class="fas fa-book"></i> 解题步骤
                        </div>
                        <ol>
                            <li><strong>步骤1：理解热阻公式</strong><br>
                                热阻 R = 厚度 L / 导热系数 k</li>
                            <li><strong>步骤2：单位换算</strong><br>
                                厚度 L = 5 mm = 5 × 10⁻³ m = 0.005 m</li>
                            <li><strong>步骤3：代入公式计算</strong><br>
                                R = L / k = 0.005 m / 2.5 W/(m·K)</li>
                            <li><strong>步骤4：计算结果</strong><br>
                                R = 0.002 m²·K/W</li>
                            <li><strong>步骤5：验证答案</strong><br>
                                单位检查：(m) / (W/(m·K)) = m²·K/W ✓</li>
                        </ol>
                    </div>
                    
                    <!-- 答案反馈区域 -->
                    <div class="answer-feedback" id="feedback1"></div>
                </div>
                
                <!-- 第2题 -->
                <div class="assessment-page" id="question2">
                    <div class="assessment-question">
                        <h4>第2题：双层串联热阻计算</h4>
                        <p>计算两层材料串联的总热阻。第一层：厚度3mm，导热系数1.2 W/m·K；第二层：厚度2mm，导热系数0.8 W/m·K。</p>
                        <p><strong>问题：</strong>计算两层材料串联的总热阻是多少？</p>
                    </div>
                    
                    <div class="assessment-inputs">
                        <div class="input-group">
                            <label for="answerInput2">总热阻 (m²·K/W):</label>
                            <input type="number" step="0.0001" id="answerInput2" placeholder="输入总热阻值">
                        </div>
                    </div>
                    
                    <div class="solution-steps" id="solution2">
                        <div class="solution-title">
                            <i class="fas fa-book"></i> 解题步骤
                        </div>
                        <ol>
                            <li><strong>步骤1：计算第一层热阻</strong><br>
                                R₁ = L₁ / k₁ = (3 × 10⁻³ m) / 1.2 W/(m·K) = 0.0025 m²·K/W</li>
                            <li><strong>步骤2：计算第二层热阻</strong><br>
                                R₂ = L₂ / k₂ = (2 × 10⁻³ m) / 0.8 W/(m·K) = 0.0025 m²·K/W</li>
                            <li><strong>步骤3：计算串联总热阻</strong><br>
                                串联总热阻 R_total = R₁ + R₂</li>
                            <li><strong>步骤4：代入计算</strong><br>
                                R_total = 0.0025 + 0.0025 = 0.0050 m²·K/W</li>
                            <li><strong>步骤5：验证结果</strong><br>
                                总热阻应该大于任一单层热阻 ✓</li>
                        </ol>
                    </div>
                    
                    <!-- 答案反馈区域 -->
                    <div class="answer-feedback" id="feedback2"></div>
                </div>
                
                <!-- 第3题 -->
                <div class="assessment-page" id="question3">
                    <div class="assessment-question">
                        <h4>第3题：三层热阻与温度计算</h4>
                        <p>计算三层结构的总热阻和中间层温度。已知：热流量为5000 W/m²，第一层热阻0.0015 m²·K/W，第二层热阻0.002 m²·K/W，第三层热阻0.0005 m²·K/W，热端温度120°C。</p>
                        <p><strong>问题：</strong>计算：(1) 总热阻 (m²·K/W) (2) 第二层右侧温度 (°C)</p>
                    </div>
                    
                    <div class="assessment-inputs">
                        <div class="input-group">
                            <label for="answerInput3_1">总热阻 (m²·K/W):</label>
                            <input type="number" step="0.0001" id="answerInput3_1" placeholder="输入总热阻">
                        </div>
                        <div class="input-group">
                            <label for="answerInput3_2">第二层右侧温度 (°C):</label>
                            <input type="number" step="0.1" id="answerInput3_2" placeholder="输入温度">
                        </div>
                    </div>
                    
                    <div class="solution-steps" id="solution3">
                        <div class="solution-title">
                            <i class="fas fa-book"></i> 解题步骤
                        </div>
                        <ol>
                            <li><strong>步骤1：计算总热阻</strong><br>
                                R_total = R₁ + R₂ + R₃ = 0.0015 + 0.002 + 0.0005 = 0.004 m²·K/W</li>
                            <li><strong>步骤2：计算总温度降</strong><br>
                                ΔT_total = q × R_total = 5000 W/m² × 0.004 m²·K/W = 20°C</li>
                            <li><strong>步骤3：计算第一层温度降</strong><br>
                                ΔT₁ = q × R₁ = 5000 × 0.0015 = 7.5°C</li>
                                计算第二层温度降</strong><br>
                                ΔT₂ = q × R₂ = 5000 × 0.002 = 10°C</li>
                            <li><strong>步骤4：计算第二层右侧温度</strong><br>
                                T₂_right = T_hot - ΔT₁- ΔT₂ = 120°C - 7.5°C- 10°C = 102.5°C</li>
                            <li><strong>步骤5：验证合理性</strong><br>
                                第二层右侧温度应该低于热端温度且高于冷端温度 ✓</li>
                        </ol>
                    </div>
                    
                    <!-- 答案反馈区域 -->
                    <div class="answer-feedback" id="feedback3"></div>
                </div>
                
                <div class="challenge-buttons">
                    <button class="btn btn-secondary" id="prevQuestionBtn">
                        <i class="fas fa-arrow-left"></i> 上一题
                    </button>
                    <button class="btn btn-primary" id="checkAnswerBtn">
                        <i class="fas fa-check-circle"></i> 检查答案
                    </button>
                    <button class="btn btn-primary" id="nextQuestionBtn" style="display: none;">
                        <i class="fas fa-arrow-right"></i> 下一题
                    </button>
                    <button class="btn btn-primary" id="submitAssessmentBtn" style="display: none;">
                        <i class="fas fa-paper-plane"></i> 提交评测
                    </button>
                </div>
            </div>
            
            <!-- 结果页面 -->
            <div class="results-panel" id="resultsPanel">
                <div class="final-rating">
                    <h3 id="finalRatingTitle">评测结果</h3>
                    <p id="finalRatingMessage">你的得分：<span id="finalScore">0</span>/3</p>
                    <p id="finalRatingLevel">评级：<span id="ratingLevel">未评级</span></p>
                </div>
                
                <div class="improvement-suggestions">
                    <h4><i class="fas fa-lightbulb"></i> 改进建议</h4>
                    <ul id="suggestionsList">
                        <!-- 改进建议将动态生成 -->
                    </ul>
                </div>
                
                <div class="detailed-results">
                    <h4><i class="fas fa-clipboard-list"></i> 详细结果分析</h4>
                    <div id="detailedResults">
                        <!-- 详细结果将动态生成 -->
                    </div>
                </div>
                
                <div class="challenge-buttons">
                    <button class="btn btn-primary" id="restartAssessmentBtn">
                        <i class="fas fa-redo"></i> 重新评测
                    </button>
                    <button class="btn btn-secondary" id="backToExplorationBtn">
                        <i class="fas fa-sliders-h"></i> 返回探索
                    </button>
                </div>
            </div>
            
            <div class="rating-system">
                <div class="rating-item" id="rating1">
                    <div class="rating-icon">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div class="rating-title">助理工程师</div>
                    <div class="rating-desc">掌握基础热阻概念</div>
                </div>
                <div class="rating-item" id="rating2">
                    <div class="rating-icon">
                        <i class="fas fa-user-cog"></i>
                    </div>
                    <div class="rating-title">工程师</div>
                    <div class="rating-desc">理解多层热阻计算</div>
                </div>
                <div class="rating-item" id="rating3">
                    <div class="rating-icon">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="rating-title">专业工程师</div>
                    <div class="rating-desc">精通热阻分析与应用</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 获取DOM元素
        const canvas = document.getElementById('thermalCanvas');
        const ctx = canvas.getContext('2d');
        
        // 获取所有控制元素
        const electrodeThickness = document.getElementById('electrodeThickness');
        const electrodeThicknessValue = document.getElementById('electrodeThicknessValue');
        const electrodeConductivity = document.getElementById('electrodeConductivity');
        const electrodeConductivityValue = document.getElementById('electrodeConductivityValue');
        
        const interfaceThickness = document.getElementById('interfaceThickness');
        const interfaceThicknessValue = document.getElementById('interfaceThicknessValue');
        const interfaceConductivity = document.getElementById('interfaceConductivity');
        const interfaceConductivityValue = document.getElementById('interfaceConductivityValue');
        
        const shellThickness = document.getElementById('shellThickness');
        const shellThicknessValue = document.getElementById('shellThicknessValue');
        const shellMaterial = document.getElementById('shellMaterial');
        
        const coolantType = document.getElementById('coolantType');
        const convectionCoefficient = document.getElementById('convectionCoefficient');
        const convectionCoefficientValue = document.getElementById('convectionCoefficientValue');
        
        // 获取结果显示元素
        const totalResistance = document.getElementById('totalResistance');
        const heatFlux = document.getElementById('heatFlux');
        const maxTemp = document.getElementById('maxTemp');
        const minTemp = document.getElementById('minTemp');
        const electrodeResistancePercent = document.getElementById('electrodeResistancePercent');
        const interfaceResistancePercent = document.getElementById('interfaceResistancePercent');
        
        // 重置按钮
        const resetBtn = document.getElementById('resetBtn');
        
        // 挑战关卡元素
        const explorationPanel = document.getElementById('explorationPanel');
        const assessmentPanel = document.getElementById('assessmentPanel');
        const resultsPanel = document.getElementById('resultsPanel');
        const modeButtons = document.querySelectorAll('.mode-btn');
        const startAssessmentBtn = document.getElementById('startAssessmentBtn');
        const assessmentPages = document.querySelectorAll('.assessment-page');
        const prevQuestionBtn = document.getElementById('prevQuestionBtn');
        const checkAnswerBtn = document.getElementById('checkAnswerBtn');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const submitAssessmentBtn = document.getElementById('submitAssessmentBtn');
        const restartAssessmentBtn = document.getElementById('restartAssessmentBtn');
        const backToExplorationBtn = document.getElementById('backToExplorationBtn');
        
        // 结果页面元素
        const finalRatingTitle = document.getElementById('finalRatingTitle');
        const finalRatingMessage = document.getElementById('finalRatingMessage');
        const finalScore = document.getElementById('finalScore');
        const finalRatingLevel = document.getElementById('finalRatingLevel');
        const ratingLevel = document.getElementById('ratingLevel');
        const suggestionsList = document.getElementById('suggestionsList');
        const detailedResults = document.getElementById('detailedResults');
        
        // 进度条元素
        const explorationProgress = document.getElementById('explorationProgress');
        const explorationProgressText = document.getElementById('explorationProgressText');
        const assessmentProgress = document.getElementById('assessmentProgress');
        const assessmentProgressText = document.getElementById('assessmentProgressText');
        
        // 评级元素
        const rating1Elem = document.getElementById('rating1');
        const rating2Elem = document.getElementById('rating2');
        const rating3Elem = document.getElementById('rating3');
        
        // 初始参数
        let params = {
            electrode: {
                thickness: 10, // mm
                conductivity: 1.5, // W/m·K
                resistance: 0
            },
            interface: {
                thickness: 0.5, // mm
                conductivity: 0.8, // W/m·K
                resistance: 0
            },
            shell: {
                thickness: 2.0, // mm
                conductivity: 237, // W/m·K (铝)
                resistance: 0
            },
            coolant: {
                coefficient: 1000, // W/m²·K
                resistance: 0
            }
        };
        
        // 温度参数 - 修正：热端100°C，冷端25°C
        const hotTemp = 100; // 电极热端温度 °C
        const coldTemp = 25; // 冷却液温度 °C
        
        // 探索模式状态
        let adjustedParameters = new Set();
        let explorationComplete = false;
        
        // 评测模式状态
        let currentQuestionIndex = 0;
        let userAnswers = [
            { answer: "", isCorrect: null, checked: false },
            { answer: "", isCorrect: null, checked: false },
            { answer1: "", answer2: "", isCorrect: null, checked: false }
        ];
        
        // 正确答案和容差
        const correctAnswers = [
            { answer: 0.002, tolerance: 0.0001 },
            { answer: 0.0050, tolerance: 0.0002 },
            { answer1: 0.004, answer2: 102.5, tolerance1: 0.0002, tolerance2: 1 }
        ];
        
        // 更新滑块显示值
        function updateSliderValues() {
            electrodeThicknessValue.textContent = parseFloat(electrodeThickness.value).toFixed(1);
            electrodeConductivityValue.textContent = parseFloat(electrodeConductivity.value).toFixed(1);
            
            interfaceThicknessValue.textContent = parseFloat(interfaceThickness.value).toFixed(2);
            interfaceConductivityValue.textContent = parseFloat(interfaceConductivity.value).toFixed(1);
            
            shellThicknessValue.textContent = parseFloat(shellThickness.value).toFixed(1);
            convectionCoefficientValue.textContent = parseFloat(convectionCoefficient.value);
            
            // 更新参数对象
            params.electrode.thickness = parseFloat(electrodeThickness.value);
            params.electrode.conductivity = parseFloat(electrodeConductivity.value);
            
            params.interface.thickness = parseFloat(interfaceThickness.value);
            params.interface.conductivity = parseFloat(interfaceConductivity.value);
            
            params.shell.thickness = parseFloat(shellThickness.value);
            params.shell.conductivity = parseFloat(shellMaterial.value);
            
            params.coolant.coefficient = parseFloat(convectionCoefficient.value);
            
            // 同步冷却液类型选择
            coolantType.value = params.coolant.coefficient;
            
            // 更新探索进度
            updateExplorationProgress();
        }
        
        // 更新探索进度
        function updateExplorationProgress() {
            // 检查哪些参数被调整过（与初始值不同）
            adjustedParameters.clear();
            
            if (parseFloat(electrodeThickness.value) !== 10) adjustedParameters.add('electrodeThickness');
            if (parseFloat(electrodeConductivity.value) !== 1.5) adjustedParameters.add('electrodeConductivity');
            if (parseFloat(interfaceThickness.value) !== 0.5) adjustedParameters.add('interfaceThickness');
            if (parseFloat(interfaceConductivity.value) !== 0.8) adjustedParameters.add('interfaceConductivity');
            if (parseFloat(shellThickness.value) !== 2.0) adjustedParameters.add('shellThickness');
            if (parseFloat(shellMaterial.value) !== 237) adjustedParameters.add('shellMaterial');
            if (parseFloat(convectionCoefficient.value) !== 1000) adjustedParameters.add('convectionCoefficient');
            
            const totalSliders = 7;
            const adjustedCount = adjustedParameters.size;
            const progressPercent = Math.min(100, Math.round((adjustedCount / totalSliders) * 100));
            
            explorationProgress.style.width = `${progressPercent}%`;
            explorationProgressText.textContent = `已调节${adjustedCount}/${totalSliders}个参数`;
            
            // 如果调整了至少3个参数，认为探索完成
            explorationComplete = adjustedCount >= 3;
            startAssessmentBtn.disabled = !explorationComplete;
            
            if (explorationComplete) {
                startAssessmentBtn.innerHTML = '<i class="fas fa-arrow-right"></i> 进入评测';
            } else {
                startAssessmentBtn.innerHTML = `<i class="fas fa-lock"></i> 请先探索（还需调整${3-adjustedCount}个参数）`;
            }
        }
        
        // 计算热阻和温度分布 - 修复黑屏问题
        function calculateThermalProperties() {
            // 将所有厚度从 mm 转换为 m
            const electrodeThicknessM = params.electrode.thickness / 1000;
            const interfaceThicknessM = params.interface.thickness / 1000;
            const shellThicknessM = params.shell.thickness / 1000;
            
            // 确保导热系数不为零，避免除零错误
            const electrodeConductivitySafe = Math.max(params.electrode.conductivity, 0.01);
            const interfaceConductivitySafe = Math.max(params.interface.conductivity, 0.01);
            const shellConductivitySafe = Math.max(params.shell.conductivity, 0.01);
            const coolantCoefficientSafe = Math.max(params.coolant.coefficient, 0.01);
            
            // 计算各层热阻 (单位: m²·K/W)
            params.electrode.resistance = electrodeThicknessM / electrodeConductivitySafe;
            params.interface.resistance = interfaceThicknessM / interfaceConductivitySafe;
            params.shell.resistance = shellThicknessM / shellConductivitySafe;
            params.coolant.resistance = 1 / coolantCoefficientSafe;
            
            // 计算总热阻
            const totalR = params.electrode.resistance + params.interface.resistance + 
                          params.shell.resistance + params.coolant.resistance;
            
            // 计算各层热阻占比
            const electrodePercent = totalR > 0 ? (params.electrode.resistance / totalR * 100).toFixed(1) : "0.0";
            const interfacePercent = totalR > 0 ? (params.interface.resistance / totalR * 100).toFixed(1) : "0.0";
            
            // 计算热流量 (假设温差为热端温度与冷端温度之差)
            const deltaT = hotTemp - coldTemp;
            // 确保总热阻不为零
            const totalRSafe = Math.max(totalR, 0.0001);
            const heatFlow = deltaT / totalRSafe; // W/m²
            
            // 计算各层温度降
            const tempDropElectrode = heatFlow * params.electrode.resistance;
            const tempDropInterface = heatFlow * params.interface.resistance;
            const tempDropShell = heatFlow * params.shell.resistance;
            const tempDropCoolant = heatFlow * params.coolant.resistance;
            
            // 计算各层边界温度 - 从热端到冷端
            const tempStart = hotTemp;
            const tempAfterElectrode = tempStart - tempDropElectrode;
            const tempAfterInterface = tempAfterElectrode - tempDropInterface;
            const tempAfterShell = tempAfterInterface - tempDropShell;
            const tempEnd = tempAfterShell - tempDropCoolant;
            
            // 确保温度值在合理范围内
            const validatedTempStart = Math.max(coldTemp, Math.min(hotTemp, tempStart));
            const validatedTempAfterElectrode = Math.max(coldTemp, Math.min(hotTemp, tempAfterElectrode));
            const validatedTempAfterInterface = Math.max(coldTemp, Math.min(hotTemp, tempAfterInterface));
            const validatedTempAfterShell = Math.max(coldTemp, Math.min(hotTemp, tempAfterShell));
            const validatedTempEnd = Math.max(coldTemp, Math.min(hotTemp, tempEnd));
            
            // 更新结果显示
            totalResistance.textContent = totalR.toFixed(4);
            heatFlux.textContent = heatFlow.toFixed(1);
            maxTemp.textContent = validatedTempStart.toFixed(1);
            minTemp.textContent = validatedTempEnd.toFixed(1);
            electrodeResistancePercent.textContent = electrodePercent;
            interfaceResistancePercent.textContent = interfacePercent;
            
            // 返回温度分布用于绘图
            return {
                temperatures: [validatedTempStart, validatedTempAfterElectrode, validatedTempAfterInterface, validatedTempAfterShell, validatedTempEnd],
                heatFlow: heatFlow,
                totalResistance: totalR,
                layerResistances: [
                    params.electrode.resistance,
                    params.interface.resistance,
                    params.shell.resistance,
                    params.coolant.resistance
                ]
            };
        }
        
        // 绘制多层热阻图
        function drawThermalLayers(thermalData) {
            // 设置Canvas尺寸
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            
            ctx.scale(dpr, dpr);
            
            const width = rect.width;
            const height = rect.height;
            
            // 清除Canvas - 确保有背景色
            ctx.fillStyle = "rgba(20, 30, 40, 0.9)";
            ctx.fillRect(0, 0, width, height);
            
            // 各层参数
            const layers = [
                { 
                    name: "电极片堆叠体", 
                    color: "#e74c3c", 
                    thickness: params.electrode.thickness,
                    resistance: params.electrode.resistance,
                    importance: "⭐⭐⭐⭐⭐"
                },
                { 
                    name: "界面层", 
                    color: "#3498db", 
                    thickness: params.interface.thickness,
                    resistance: params.interface.resistance,
                    importance: "⭐⭐⭐⭐"
                },
                { 
                    name: "金属外壳", 
                    color: "#2ecc71", 
                    thickness: params.shell.thickness,
                    resistance: params.shell.resistance,
                    importance: "⭐"
                },
                { 
                    name: "冷却液对流", 
                    color: "#9b59b6", 
                    thickness: 5, // 虚拟厚度，用于显示
                    resistance: params.coolant.resistance,
                    importance: "⭐⭐"
                }
            ];
            
            // 计算总厚度用于缩放
            const totalThickness = layers.reduce((sum, layer) => sum + layer.thickness, 0);
            const maxAvailableWidth = width * 0.7; // 留出空间给标尺
            const scaleFactor = maxAvailableWidth / Math.max(totalThickness, 1);
            
            // 确保最小缩放因子，避免层太窄
            const minScaleFactor = 5;
            const actualScaleFactor = Math.max(scaleFactor, minScaleFactor);
            
            // 绘制各层
            let currentX = width * 0.1;
            const layerHeight = height * 0.5; // 降低层高度
            const layerY = height * 0.25; // 从更上方开始
            
            // 绘制温度梯度背景 - 修复颜色映射
            drawTemperatureGradient(currentX, layerY, maxAvailableWidth, layerHeight, thermalData.temperatures);
            
            // 绘制各层
            for (let i = 0; i < layers.length; i++) {
                const layer = layers[i];
                const layerWidth = Math.max(layer.thickness * actualScaleFactor, 10); // 确保最小宽度
                
                // 绘制层矩形
                ctx.fillStyle = layer.color + "80"; // 添加透明度
                ctx.fillRect(currentX, layerY, layerWidth, layerHeight);
                
                // 绘制层边框
                ctx.strokeStyle = layer.color;
                ctx.lineWidth = 0.1;
                ctx.strokeRect(currentX, layerY, layerWidth, layerHeight);
                
                // 绘制层名称（横向，在下半部分）
                ctx.fillStyle = "#ffffff";
                ctx.font = "bold 9px 'Segoe UI'";
                ctx.textAlign = "center";
                ctx.textBaseline = "middle";
                ctx.fillText(layer.name, currentX + layerWidth/2, layerY + layerHeight * 0.8);
                
                // 绘制层厚度（在名称下方）
                ctx.font = "8px 'Segoe UI'";
                ctx.fillStyle = "#e0e0e0";
                ctx.textAlign = "center";
                ctx.textBaseline = "top";
                ctx.fillText(
                    `${layer.thickness} mm`, 
                    currentX + layerWidth/2, 
                    layerY + layerHeight * 0.9
                );
                
                // 绘制热阻值
                ctx.fillStyle = "#b0bec5";
                ctx.font = "8px 'Segoe UI'";
                ctx.fillText(
                    `R: ${layer.resistance.toFixed(4)}`, 
                    currentX + layerWidth/2, 
                    layerY + layerHeight + 5
                );
                
                // 绘制重要性评级
                ctx.fillStyle = "#f1c40f";
                ctx.font = "bold 7px 'Segoe UI'";
                ctx.fillText(
                    layer.importance, 
                    currentX + layerWidth/2, 
                    layerY - 20
                );
                
                // 绘制温度值 - 明确标注实际温度，不是温差
                ctx.fillStyle = "#e74c3c";
                ctx.font = "bold 12px 'Segoe UI'";
                ctx.textAlign = "center";
                
                // 左侧温度
                if (i === 0) {
                    ctx.fillText(
                        `${thermalData.temperatures[0].toFixed(1)}°C`, 
                        currentX - 25, 
                        layerY + layerHeight/2
                    );
                }
                
                // 右侧温度
                const tempValue = thermalData.temperatures[i+1];
                if (!isNaN(tempValue) && isFinite(tempValue)) {
                    ctx.fillText(
                        `${tempValue.toFixed(1)}°C`, 
                        currentX + layerWidth + 25, 
                        layerY + layerHeight/2
                    );
                }
                
                // 绘制温度降箭头
                const tempDrop = thermalData.temperatures[i] - thermalData.temperatures[i+1];
                if (!isNaN(tempDrop) && isFinite(tempDrop)) {
                    drawTemperatureArrow(
                        currentX + layerWidth/2, 
                        layerY + layerHeight/2 - 15,
                        tempDrop
                    );
                }
                
                currentX += layerWidth;
            }
            
            // 绘制热流方向箭头
            drawHeatFlowArrow(width * 0.05, layerY + layerHeight/2, width * 0.95, layerY + layerHeight/2);
            
            // 绘制标题
            ctx.fillStyle = "#4fc3f7";
            ctx.font = "bold 20px 'Segoe UI'";
            ctx.textAlign = "center";
            ctx.textBaseline = "top";
            ctx.fillText("电池包多层热阻与温差分布", width/2, 14);
            
            // 绘制热流量
            ctx.fillStyle = "#3498db";
            ctx.font = "14px 'Segoe UI'";
            ctx.fillText(`热流量: ${thermalData.heatFlow.toFixed(1)} W/m²`, width/2, height - 20);
        }
        
        // 绘制温度梯度背景 - 修正颜色映射
        function drawTemperatureGradient(x, y, width, height, temperatures) {
            // 确保所有温度值有效
            const validTemperatures = temperatures.filter(t => !isNaN(t) && isFinite(t));
            if (validTemperatures.length < 2) {
                // 如果温度无效，绘制默认背景
                ctx.fillStyle = "rgba(30, 40, 55, 0.9)";
                ctx.fillRect(x, y, width, height);
                return;
            }
            
            // 创建温度梯度
            const gradient = ctx.createLinearGradient(x, y, x + width, y);
            
            // 根据温度值设置渐变颜色 - 修正颜色映射
            // 100°C -> 红色 (#e74c3c), 25°C -> 蓝色 (#2980b9)
            
            // 计算颜色停止点
            const tempRange = hotTemp - coldTemp; // 100-25 = 75°C
            
            // 为每个温度点添加颜色停止
            for (let i = 0; i < temperatures.length; i++) {
                const temp = temperatures[i];
                if (isNaN(temp) || !isFinite(temp)) continue;
                
                const position = (temp - coldTemp) / tempRange; // 0-1范围，0对应25°C，1对应100°C
                const clampedPosition = Math.max(0, Math.min(1, position));
                
                // 根据温度值计算颜色 (从红色到蓝色)
                const r = Math.floor(231 - (231-41) * clampedPosition); // 231->41
                const g = Math.floor(76 - (76-128) * clampedPosition); // 76->128
                const b = Math.floor(60 + (182-60) * clampedPosition); // 60->182
                
                gradient.addColorStop(clampedPosition, `rgb(${r}, ${g}, ${b})`);
            }
            
            // 绘制渐变矩形
            ctx.fillStyle = gradient;
            ctx.fillRect(x, y, width, height);
            
            // 添加半透明覆盖层以增加可读性
            ctx.fillStyle = "rgba(255, 255, 255, 0.05)";
            ctx.fillRect(x, y, width, height);
        }
        
        // 绘制温度降箭头
        function drawTemperatureArrow(x, y, tempDrop) {
            if (isNaN(tempDrop) || !isFinite(tempDrop)) return;
            
            const arrowSize = 12;
            
            // 绘制箭头
            ctx.fillStyle = tempDrop > 10 ? "#e74c3c" : "#3498db";
            ctx.beginPath();
            ctx.moveTo(x - arrowSize/2, y);
            ctx.lineTo(x + arrowSize/2, y);
            ctx.lineTo(x, y + arrowSize);
            ctx.closePath();
            ctx.fill();
            
            // 绘制温度降文本
            ctx.fillStyle = "#e0e0e0";
            ctx.font = "14px 'Segoe UI'";
            ctx.textAlign = "center";
            ctx.textBaseline = "bottom";
            ctx.fillText(`${tempDrop.toFixed(1)}°C`, x, y - 3);
        }
        
        // 绘制热流方向箭头
        function drawHeatFlowArrow(startX, startY, endX, endY) {
            const arrowSize = 8;
            
            // 绘制线
            ctx.strokeStyle = "#ff9800";
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(startX, startY);
            ctx.lineTo(endX, startY);
            ctx.stroke();
            
            // 绘制箭头
            ctx.fillStyle = "#ff9800";
            ctx.beginPath();
            ctx.moveTo(endX, startY);
            ctx.lineTo(endX - arrowSize, startY - arrowSize/2);
            ctx.lineTo(endX - arrowSize, startY + arrowSize/2);
            ctx.closePath();
            ctx.fill();
            
            // 绘制标签
            ctx.fillStyle = "#ff9800";
            ctx.font = "bold 10px 'Segoe UI'";
            ctx.textAlign = "center";
            ctx.textBaseline = "bottom";
            ctx.fillText("热流方向", (startX + endX)/2, startY - 8);
        }
        
        // 更新Canvas大小并重绘
        function updateCanvas() {
            updateSliderValues();
            const thermalData = calculateThermalProperties();
            drawThermalLayers(thermalData);
        }
        
        // 显示指定的评测问题页面
        function showAssessmentPage(pageIndex) {
            currentQuestionIndex = pageIndex;
            
            // 隐藏所有页面
            assessmentPages.forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示当前页面
            assessmentPages[pageIndex].classList.add('active');
            
            // 更新进度条
            const progressPercent = Math.round(((pageIndex + 1) / assessmentPages.length) * 100);
            assessmentProgress.style.width = `${progressPercent}%`;
            assessmentProgressText.textContent = `第${pageIndex + 1}题/共${assessmentPages.length}题`;
            
            // 更新按钮状态
            prevQuestionBtn.style.display = pageIndex > 0 ? "inline-block" : "none";
            
            if (pageIndex < assessmentPages.length - 1) {
                checkAnswerBtn.style.display = "inline-block";
                nextQuestionBtn.style.display = userAnswers[pageIndex].checked ? "inline-block" : "none";
                submitAssessmentBtn.style.display = "none";
            } else {
                checkAnswerBtn.style.display = "inline-block";
                nextQuestionBtn.style.display = "none";
                submitAssessmentBtn.style.display = userAnswers[pageIndex].checked ? "inline-block" : "none";
            }
            
            // 恢复已检查的答案的反馈显示
            if (userAnswers[pageIndex].checked) {
                showAnswerFeedback(pageIndex);
            }
        }
        
        // 检查当前问题的答案
        function checkCurrentAnswer() {
            const answerInput1 = document.getElementById('answerInput1');
            const answerInput2 = document.getElementById('answerInput2');
            const answerInput3_1 = document.getElementById('answerInput3_1');
            const answerInput3_2 = document.getElementById('answerInput3_2');
            
            // 保存用户答案
            if (currentQuestionIndex === 0 && answerInput1) {
                userAnswers[0].answer = answerInput1.value;
                userAnswers[0].checked = true;
            } else if (currentQuestionIndex === 1 && answerInput2) {
                userAnswers[1].answer = answerInput2.value;
                userAnswers[1].checked = true;
            } else if (currentQuestionIndex === 2 && answerInput3_1 && answerInput3_2) {
                userAnswers[2].answer1 = answerInput3_1.value;
                userAnswers[2].answer2 = answerInput3_2.value;
                userAnswers[2].checked = true;
            }
            
            // 检查答案正确性
            let isCorrect = false;
            const correct = correctAnswers[currentQuestionIndex];
            
            if (currentQuestionIndex === 0) {
                const userAnswer = parseFloat(userAnswers[0].answer);
                isCorrect = !isNaN(userAnswer) && Math.abs(userAnswer - correct.answer) <= correct.tolerance;
                userAnswers[0].isCorrect = isCorrect;
            } else if (currentQuestionIndex === 1) {
                const userAnswer = parseFloat(userAnswers[1].answer);
                isCorrect = !isNaN(userAnswer) && Math.abs(userAnswer - correct.answer) <= correct.tolerance;
                userAnswers[1].isCorrect = isCorrect;
            } else if (currentQuestionIndex === 2) {
                const userAnswer1 = parseFloat(userAnswers[2].answer1);
                const userAnswer2 = parseFloat(userAnswers[2].answer2);
                const isCorrect1 = !isNaN(userAnswer1) && Math.abs(userAnswer1 - correct.answer1) <= correct.tolerance1;
                const isCorrect2 = !isNaN(userAnswer2) && Math.abs(userAnswer2 - correct.answer2) <= correct.tolerance2;
                isCorrect = isCorrect1 && isCorrect2;
                userAnswers[2].isCorrect = isCorrect;
            }
            
            // 显示反馈
            showAnswerFeedback(currentQuestionIndex);
            
            // 更新按钮状态
            if (currentQuestionIndex < assessmentPages.length - 1) {
                nextQuestionBtn.style.display = "inline-block";
                checkAnswerBtn.style.display = "none";
            } else {
                submitAssessmentBtn.style.display = "inline-block";
                checkAnswerBtn.style.display = "none";
            }
            
            return isCorrect;
        }
        
        // 显示答案反馈
        function showAnswerFeedback(questionIndex) {
            const feedbackElem = document.getElementById(`feedback${questionIndex + 1}`);
            const solutionElem = document.getElementById(`solution${questionIndex + 1}`);
            
            if (feedbackElem && solutionElem) {
                const isCorrect = userAnswers[questionIndex].isCorrect;
                
                if (isCorrect) {
                    feedbackElem.textContent = "✓ 回答正确！请查看下面的解题步骤。";
                    feedbackElem.className = "answer-feedback correct";
                } else {
                    feedbackElem.textContent = "✗ 回答不正确。请查看下面的解题步骤并修正答案。";
                    feedbackElem.className = "answer-feedback incorrect";
                }
                
                feedbackElem.style.display = "block";
                solutionElem.classList.add('show');
                
                // 滚动到反馈区域
                setTimeout(() => {
                    feedbackElem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }, 100);
            }
        }
        
        // 提交所有答案并显示结果
        function submitAssessment() {
            // 检查最后一题的答案
            const isCorrect = checkCurrentAnswer();
            
            // 计算总分
            let score = 0;
            userAnswers.forEach(answer => {
                if (answer.isCorrect === true) score++;
            });
            
            // 显示结果页面
            showResultsPage(score);
        }
        
        // 显示结果页面 - 修正评级逻辑
        function showResultsPage(score) {
            explorationPanel.style.display = "none";
            assessmentPanel.style.display = "none";
            resultsPanel.style.display = "block";
            
            // 更新模式按钮
            modeButtons.forEach(btn => {
                if (btn.getAttribute("data-mode") === "results") {
                    btn.style.display = "flex";
                    btn.classList.add("active");
                } else {
                    btn.classList.remove("active");
                }
            });
            
            // 确定评级 - 按照助理工程师、工程师和专业工程师来评价
            let rating = "";
            let ratingMessage = "";
            let suggestions = [];
            
            if (score === 3) {
                rating = "专业工程师";
                ratingMessage = "恭喜你！你已经达到专业工程师级别！";
                suggestions = [
                    "你已经精通多层热阻计算，可以进一步学习瞬态热分析和复杂热管理系统设计。",
                    "建议研究实际工程案例中的热阻网络分析。",
                    "可以探索不同冷却方式（风冷、液冷、相变冷却）对热阻的影响。"
                ];
            } else if (score >= 2) {
                rating = "工程师";
                ratingMessage = "恭喜你！你已经达到工程师级别！";
                suggestions = [
                    "你已掌握多层热阻计算，但在复杂温度计算方面还需加强训练。",
                    "建议多做温度分布计算练习，理解热流量与温度降的关系。",
                    "可以尝试设计不同材料组合的多层结构，优化热阻分布。"
                ];
            } else if (score >= 1) {
                rating = "助理工程师";
                ratingMessage = "恭喜你！你已经达到助理工程师级别！";
                suggestions = [
                    "你已掌握基础热阻计算，但在多层热阻串联和温度计算方面还需加强训练。",
                    "建议重点练习单位换算和热阻串联计算。",
                    "可以重新学习热阻基本公式：R = L/k（固体层）和 R = 1/h（对流层）。"
                ];
            } else {
                rating = "未通过第一级";
                ratingMessage = "想成为助理工程师，还需要继续努力哦！";
                suggestions = [
                    "建议从基础热阻概念开始复习，理解热阻计算公式和单位换算。",
                    "可以从单层热阻计算开始练习，逐步过渡到多层计算。",
                    "多使用探索模式观察参数变化对热阻和温度分布的影响。"
                ];
            }
            
            // 更新结果页面内容
            finalRatingTitle.textContent = ratingMessage;
            finalScore.textContent = score;
            ratingLevel.textContent = rating;
            
            // 更新改进建议
            suggestionsList.innerHTML = "";
            suggestions.forEach(suggestion => {
                const li = document.createElement("li");
                li.textContent = suggestion;
                suggestionsList.appendChild(li);
            });
            
            // 更新详细结果
            detailedResults.innerHTML = "";
            
            // 第1题结果
            const result1 = document.createElement("div");
            result1.className = `question-result ${userAnswers[0].isCorrect ? "correct" : "incorrect"}`;
            result1.innerHTML = `
                <div class="question-header">
                    <div class="question-title">第1题：单层热阻计算</div>
                    <div class="question-status ${userAnswers[0].isCorrect ? "status-correct" : "status-incorrect"}">
                        ${userAnswers[0].isCorrect ? "正确" : "错误"}
                    </div>
                </div>
                <p><strong>你的答案：</strong>${userAnswers[0].answer || "未回答"} m²·K/W</p>
                <p><strong>正确答案：</strong>0.002 m²·K/W</p>
                <p><strong>解题要点：</strong>R = L/k，注意单位换算（mm → m）</p>
            `;
            detailedResults.appendChild(result1);
            
            // 第2题结果
            const result2 = document.createElement("div");
            result2.className = `question-result ${userAnswers[1].isCorrect ? "correct" : "incorrect"}`;
            result2.innerHTML = `
                <div class="question-header">
                    <div class="question-title">第2题：双层串联热阻计算</div>
                    <div class="question-status ${userAnswers[1].isCorrect ? "status-correct" : "status-incorrect"}">
                        ${userAnswers[1].isCorrect ? "正确" : "错误"}
                    </div>
                </div>
                <p><strong>你的答案：</strong>${userAnswers[1].answer || "未回答"} m²·K/W</p>
                <p><strong>正确答案：</strong>0.0050 m²·K/W</p>
                <p><strong>解题要点：</strong>R_total = R₁ + R₂，分别计算每层热阻再相加</p>
            `;
            detailedResults.appendChild(result2);
            
            // 第3题结果
            const result3 = document.createElement("div");
            result3.className = `question-result ${userAnswers[2].isCorrect ? "correct" : "incorrect"}`;
            result3.innerHTML = `
                <div class="question-header">
                    <div class="question-title">第3题：三层热阻与温度计算</div>
                    <div class="question-status ${userAnswers[2].isCorrect ? "status-correct" : "status-incorrect"}">
                        ${userAnswers[2].isCorrect ? "正确" : "错误"}
                    </div>
                </div>
                <p><strong>你的答案：</strong>总热阻 ${userAnswers[2].answer1 || "未回答"} m²·K/W，温度 ${userAnswers[2].answer2 || "未回答"} °C</p>
                <p><strong>正确答案：</strong>总热阻 0.004 m²·K/W，温度 102.5 °C</p>
                <p><strong>解题要点：</strong>总热阻 = R₁ + R₂ + R₃，温度降 = q × R，逐层计算温度</p>
            `;
            detailedResults.appendChild(result3);
            
            // 更新评级显示
            updateRatingDisplay(score);
        }
        
        // 更新评级显示
        function updateRatingDisplay(score) {
            // 重置所有评级
            rating1Elem.classList.remove("active");
            rating2Elem.classList.remove("active");
            rating3Elem.classList.remove("active");
            
            // 根据得分激活相应的评级
            if (score >= 1) {
                rating1Elem.classList.add("active"); // 助理工程师
            }
            if (score >= 2) {
                rating2Elem.classList.add("active"); // 工程师
            }
            if (score >= 3) {
                rating3Elem.classList.add("active"); // 专业工程师
            }
        }
        
        // 切换到评测模式
        function switchToAssessment() {
            explorationPanel.style.display = "none";
            assessmentPanel.style.display = "block";
            resultsPanel.style.display = "none";
            
            // 更新模式按钮
            modeButtons.forEach(btn => {
                if (btn.getAttribute("data-mode") === "assessment") {
                    btn.classList.add("active");
                } else {
                    btn.classList.remove("active");
                }
            });
            
            // 显示第一题
            showAssessmentPage(0);
        }
        
        // 切换到探索模式
        function switchToExploration() {
            explorationPanel.style.display = "block";
            assessmentPanel.style.display = "none";
            resultsPanel.style.display = "none";
            
            // 更新模式按钮
            modeButtons.forEach(btn => {
                if (btn.getAttribute("data-mode") === "exploration") {
                    btn.classList.add("active");
                } else {
                    btn.classList.remove("active");
                }
                if (btn.getAttribute("data-mode") === "results") {
                    btn.style.display = "none";
                }
            });
        }
        
        // 重置评测
        function resetAssessment() {
            // 重置答案
            userAnswers = [
                { answer: "", isCorrect: null, checked: false },
                { answer: "", isCorrect: null, checked: false },
                { answer1: "", answer2: "", isCorrect: null, checked: false }
            ];
            
            // 重置输入框
            document.getElementById('answerInput1').value = "";
            document.getElementById('answerInput2').value = "";
            document.getElementById('answerInput3_1').value = "";
            document.getElementById('answerInput3_2').value = "";
            
            // 隐藏所有解题步骤
            document.querySelectorAll('.solution-steps').forEach(step => {
                step.classList.remove('show');
            });
            
            // 隐藏所有反馈
            document.querySelectorAll('.answer-feedback').forEach(feedback => {
                feedback.style.display = "none";
            });
            
            // 切换回评测模式
            switchToAssessment();
        }
        
        // 初始化事件监听
        function initEventListeners() {
            // 监听所有滑块的变化
            const sliders = [
                electrodeThickness, electrodeConductivity,
                interfaceThickness, interfaceConductivity,
                shellThickness, convectionCoefficient
            ];
            
            sliders.forEach(slider => {
                slider.addEventListener('input', updateCanvas);
            });
            
            // 监听选择框的变化
            shellMaterial.addEventListener('change', function() {
                convectionCoefficient.value = this.value === "237" ? "1000" : "800";
                convectionCoefficientValue.textContent = convectionCoefficient.value;
                params.coolant.coefficient = parseFloat(convectionCoefficient.value);
                coolantType.value = params.coolant.coefficient;
                updateCanvas();
            });
            
            coolantType.addEventListener('change', function() {
                convectionCoefficient.value = this.value;
                convectionCoefficientValue.textContent = this.value;
                params.coolant.coefficient = parseFloat(this.value);
                updateCanvas();
            });
            
            // 重置按钮
            resetBtn.addEventListener('click', function() {
                electrodeThickness.value = 10;
                electrodeConductivity.value = 1.5;
                
                interfaceThickness.value = 0.5;
                interfaceConductivity.value = 0.8;
                
                shellThickness.value = 2.0;
                shellMaterial.value = 237;
                
                coolantType.value = 1000;
                convectionCoefficient.value = 1000;
                
                updateCanvas();
            });
            
            // 模式切换按钮
            modeButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const mode = this.getAttribute("data-mode");
                    
                    if (mode === "exploration") {
                        switchToExploration();
                    } else if (mode === "assessment") {
                        if (explorationComplete) {
                            switchToAssessment();
                        } else {
                            alert("请先完成探索模式，调整至少3个参数后再进入评测。");
                        }
                    } else if (mode === "results") {
                        // 结果页面按钮 - 不做操作，因为结果页面已经显示
                    }
                });
            });
            
            // 开始评测按钮
            startAssessmentBtn.addEventListener('click', function() {
                if (explorationComplete) {
                    switchToAssessment();
                } else {
                    alert("请先完成探索模式，调整至少3个参数后再进入评测。");
                }
            });
            
            // 评测导航按钮
            prevQuestionBtn.addEventListener('click', function() {
                if (currentQuestionIndex > 0) {
                    showAssessmentPage(currentQuestionIndex - 1);
                }
            });
            
            checkAnswerBtn.addEventListener('click', checkCurrentAnswer);
            
            nextQuestionBtn.addEventListener('click', function() {
                showAssessmentPage(currentQuestionIndex + 1);
            });
            
            submitAssessmentBtn.addEventListener('click', submitAssessment);
            
            // 结果页面按钮
            restartAssessmentBtn.addEventListener('click', resetAssessment);
            
            backToExplorationBtn.addEventListener('click', switchToExploration);
            
            // 窗口大小变化时重绘
            window.addEventListener('resize', updateCanvas);
        }
        
        // 初始化
        function init() {
            updateSliderValues();
            initEventListeners();
            updateCanvas();
            updateExplorationProgress();
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', init);
    </script>


<!-- 底部信息栏 -->
<div style="
    text-align: center;
    padding: 20px 30px;
    margin-top: 40px;
    color: #e6f7ff;
    font-size: 0.9rem;
    border-top: 2px solid rgba(0, 180, 255, 0.5);
    background: linear-gradient(135deg, rgba(10, 15, 43, 0.95), rgba(18, 26, 58, 0.9));
    border-radius: 15px 15px 0 0;
    box-shadow: 0 -10px 30px rgba(0, 180, 255, 0.1);
    position: relative;
    overflow: hidden;
    box-sizing: border-box;
    width: 100%;
    max-width: none;
">
    <div style="position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, #00b4ff, #6c8cff, #00b4ff);"></div>
    
    <p style="font-size: 1.3rem; font-weight: bold; margin-bottom: 15px; color: #00b4ff;">
        电池包多层热阻模拟训练器 © 2025 | 传热交互仿真系统 | 版本 1.0 |
      <style="margin-bottom: 12px; color: #cbd5e1;">
        <strong>邮箱:</strong> xgyanger@qq.com
    </p>
    
    <div style="margin-top: 15px;">
        <span style="color: #ffcc00; font-weight: bold; font-size: 1.1rem;">
            版权©2025 AIknow. 保留所有权利 | Copyright ©2025 AIknow. All rights reserved.
        </span>
    </div>
</div>



</body>
</html>